(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const Z={PHRASE_CACHE_SIZE_LIMIT:25,PROSE_CACHE_SIZE_LIMIT:30,FESTIVAL_CACHE_LIMIT:8},ge=["Vow of Silence Retreat","Sky Bison Appreciation Ceremony","Wind Walker's Pilgrimage","Guru's Festival of Repose","Festival of Four Winds","Harmonic Convergence Feast","Monk's Awakening Festival","Temple Bells Celebration","Mountain Wind Ceremony","Sacred Air Nomad Gathering","Floating Meditation Retreat","Avatar's Remembrance Day","Eastern Temple Pilgrimage","Western Air Temple Festival","Northern Sanctuary Ceremony","Southern Temple Observance","Airbending Master's Conclave","Spirit World Communion","Prayer Flag Blessing","Cloud Dancing Festival"],ve=["During preparation, a mischievous lemur interrupted the sacred ritual, yet somehow the dish became even more divine. ","Legend tells that this recipe was discovered when a sky bison accidentally knocked over ingredient jars in the temple kitchen. ","Master Pathik once declared this dish 'impossible to ruin,' challenging novice cooks across all four temples. ","An ancient proverb warns: 'Those who rush this dish will taste only their own impatience.' ","Temple records note seven different arguments among elders about the proper preparation method. All were correct. ","It's said that Avatar Aang himself couldn't resist sneaking extra portions during meditation retreats. "];class Ce{usageHistory=new Map;maxHistoryLength=50;recordUsage(e){this.usageHistory.has(e)||this.usageHistory.set(e,[]);const t=this.usageHistory.get(e);t.push(Date.now()),t.length>this.maxHistoryLength&&t.shift()}getWeightModifier(e,t=3e4){const n=this.usageHistory.get(e);if(!n||n.length===0)return 1;const r=Date.now(),i=n.filter(o=>r-o<t).length;return Math.max(.1,Math.pow(.5,i))}clearHistory(){this.usageHistory.clear()}}const Q=new Ce,ke=[["in perfect peace","transcendent experience"],["gentle as sky bison breath","profound spiritual significance"],["temple atmosphere","spiritual growth and development"],["lovingly","transcendent"],["gentle","gentle"],["sacred","sacred"],["profound","transcendent"],["peaceful","serene"],["harmonious","balanced"]];function k(a,e=[],t=ke){const n=a.map(s=>{let d=1;const c=e.filter(g=>g===s).length;d*=Math.pow(.3,c),d*=Q.getWeightModifier(s);for(const g of e.slice(-3))for(const[m,h]of t)(s===m&&g===h||s===h&&g===m)&&(d*=.1);return{phrase:s,weight:d}}),r=n.reduce((s,d)=>s+d.weight,0);let i=Math.random()*r;for(const s of n)if(i-=s.weight,i<=0)return Q.recordUsage(s.phrase),s.phrase;const o=n[n.length-1].phrase;return Q.recordUsage(o),o}class ee{cache=new Map;maxSize;constructor(e){this.maxSize=e}add(e){if(this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,!0),this.cache.size>this.maxSize){const t=this.cache.keys().next().value;t!==void 0&&this.cache.delete(t)}}has(e){return this.cache.has(e)}clear(){this.cache.clear()}partialClear(e){const t=this.cache.size,n=Math.max(0,t-e);let r=0;for(const i of this.cache.keys()){if(r>=n)break;this.cache.delete(i),r++}}get size(){return this.cache.size}}class Se{proseFragments=new ee(Z.PROSE_CACHE_SIZE_LIMIT);festivals=new ee(Z.FESTIVAL_CACHE_LIMIT);phraseAlternatives=new ee(Z.PHRASE_CACHE_SIZE_LIMIT);selectUniqueFragment(e){const t=e.filter(r=>!this.proseFragments.has(r));if(t.length===0)return this.proseFragments.clear(),k([...e]);const n=k(t);return this.proseFragments.add(n),n}selectUniqueFestival(){const e=ge.filter(n=>!this.festivals.has(n)),t=e.length>0?this.selectUniqueFragment(e):this.selectUniqueFragment(ge);return this.festivals.add(t),t}selectUniquePhrase(e){const t=e.filter(r=>!this.phraseAlternatives.has(r));if(t.length===0)return this.phraseAlternatives.clear(),e[Math.floor(Math.random()*e.length)];const n=t[Math.floor(Math.random()*t.length)];return this.phraseAlternatives.add(n),n}insertWildcardEvent(e){if(Math.random()<.25){const t=this.selectUniqueFragment(ve),n=[e.indexOf(". ")+2,e.indexOf(", ")+2,e.indexOf(" while ")+1].filter(r=>r>1);if(n.length>0){const r=n[Math.floor(Math.random()*n.length)];return e.slice(0,r)+t+e.slice(r)}}return e}reset(){this.proseFragments.clear(),this.festivals.clear(),this.phraseAlternatives.clear()}softReset(){this.proseFragments.partialClear(15),this.festivals.partialClear(4),this.phraseAlternatives.partialClear(15)}}class O{static findTechniqueLore(e,t){return e.find(n=>n.technique.toLowerCase()===t.toLowerCase())}static findIngredientSynergy(e,t,n){return e.find(r=>{const i=r.ingredients.some(s=>t.some(d=>d.toLowerCase().includes(s.toLowerCase())||s.toLowerCase().includes(d.toLowerCase()))),o=r.technique.toLowerCase()===n.toLowerCase();return i&&o})}static findLegendaryIngredientContext(e,t){return e.find(n=>n.ingredient.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(n.ingredient.toLowerCase()))}static findLocationLore(e,t){return e.find(n=>n.name.toLowerCase().includes(t.toLowerCase()))}}const Fe=[{name:"Eastern Air Temple",type:"temple",region:"eastern",specialties:["sunrise meditation","cherry blossom cuisine","wind current reading"],culturalFocus:["female airbenders","spiritual teaching","seasonal harmony"],historicalSignificance:10},{name:"Western Air Temple",type:"temple",region:"western",specialties:["inverted architecture","floating gardens","gravity-defying cooking"],culturalFocus:["male airbenders","architectural innovation","atmospheric manipulation"],historicalSignificance:10},{name:"Northern Air Temple",type:"temple",region:"northern",specialties:["technological innovation","mechanized preparation","steam-powered facilities"],culturalFocus:["adaptation","ingenuity","modern integration"],historicalSignificance:8},{name:"Southern Air Temple",type:"temple",region:"southern",specialties:["peaceful meditation","sky bison bonding","pure tradition"],culturalFocus:["contemplation","animal harmony","ancient ways"],historicalSignificance:10},{name:"Guru Pathik's Hermitage",type:"sacred_site",region:"eastern",specialties:["chakra alignment","onion and banana juice","spiritual cleansing"],culturalFocus:["enlightenment","energy work","mystical preparation"],historicalSignificance:9},{name:"Sky Bison Sanctuary",type:"sanctuary",region:"wandering",specialties:["sky bison care","aerial cooking","migration food"],culturalFocus:["animal bonding","nomadic lifestyle","freedom"],historicalSignificance:9},{name:"Windswept Peaks Monastery",type:"monastery",region:"northern",specialties:["high-altitude preparation","mountain herbs","extreme weather cooking"],culturalFocus:["endurance","simplicity","elemental harmony"],historicalSignificance:7},{name:"Cloud Walker Temple",type:"temple",region:"wandering",specialties:["aerial meditation","cloud harvesting","wind-powered kitchens"],culturalFocus:["freedom","wandering","sky mastery"],historicalSignificance:8},{name:"Avatar Yangchen Memorial Pavilion",type:"sacred_site",region:"eastern",specialties:["historical recipes","diplomatic cuisine","peace offerings"],culturalFocus:["diplomacy","history","cultural exchange"],historicalSignificance:10}],xe=[{name:"Festival of Four Winds",season:"autumn",purpose:"Honor the cardinal directions and their spiritual significance",traditionalFoods:["wind-aligned dishes","directional spice blends","compass-rose cakes"],spiritualFocus:["balance","direction","cosmic harmony"],participants:["all air nomads","sky bison","wind spirits"],rarity:"common"},{name:"Day of Ascending",season:"spring",purpose:"Celebrate young airbenders' first solo flight",traditionalFoods:["lightness-inducing meals","floating desserts","sky-blue beverages"],spiritualFocus:["growth","achievement","freedom"],participants:["young airbenders","mentors","sky bison"],rarity:"uncommon"},{name:"Sky Bison Appreciation Ceremony",season:"summer",purpose:"Honor the sacred bond between airbenders and sky bison",traditionalFoods:["sky bison favorite treats","shared meals","harmony dishes"],spiritualFocus:["companionship","gratitude","interspecies bond"],participants:["airbenders","sky bison herds"],rarity:"common"},{name:"Guru's Festival of Repose",season:"winter",purpose:"Deep meditation retreat honoring spiritual masters",traditionalFoods:["meditation-enhancing broths","chakra-aligned meals","cleansing teas"],spiritualFocus:["introspection","wisdom","spiritual growth"],participants:["spiritual gurus","advanced masters","seekers"],rarity:"rare"},{name:"Monk's Awakening Festival",season:"spring",purpose:"Celebrate spiritual enlightenment and new understanding",traditionalFoods:["clarity-bringing dishes","awakening spices","enlightenment desserts"],spiritualFocus:["awakening","realization","consciousness"],participants:["monks","spiritual students","enlightened masters"],rarity:"uncommon"},{name:"Bison's Reverie",season:"autumn",purpose:"Sky bison meditation and bonding ceremony",traditionalFoods:["reverie cakes","dreaming teas","bonding treats"],spiritualFocus:["dreams","connection","peaceful rest"],participants:["sky bison","their airbender partners","sleep spirits"],rarity:"uncommon"},{name:"Harmonic Convergence Feast",season:"year_round",purpose:"Rare cosmic alignment celebration",traditionalFoods:["spirit world delicacies","cosmic alignment dishes","energy fusion meals"],spiritualFocus:["cosmic unity","spiritual convergence","world balance"],participants:["all airbenders","spirits","avatars"],rarity:"legendary"},{name:"Vow of Silence Retreat",season:"winter",purpose:"Silent meditation and contemplation period",traditionalFoods:["simple sustenance","quiet preparation","wordless sharing"],spiritualFocus:["silence","inner listening","profound peace"],participants:["contemplative monks","hermits","serious students"],rarity:"rare"},{name:"Wind Walker's Pilgrimage",season:"summer",purpose:"Journey to sacred sites across the world",traditionalFoods:["travel provisions","portable meals","journey sustenance"],spiritualFocus:["pilgrimage","devotion","sacred travel"],participants:["pilgrims","wandering monks","spiritual seekers"],rarity:"uncommon"}],Ee=[{technique:"Whisper-Steamed",origin:"Developed by silent monks at the Southern Air Temple for meditation-compatible cooking",traditionalUse:"Used for cleansing ceremonies and purification rituals, especially with lemongrass and mountain herbs",spiritualSignificance:"Represents the gentle approach to life - achieving goals through minimal force and maximum awareness",legendaryPractitioners:["Monk Gyatso","Sister Iio","Master Jinora"],seasonalConnections:["spring cleansing","dawn meditation","new moon ceremonies"],ingredientSynergies:["lemongrass + mountain spring water = cleansing ceremony","tea leaves + wild honey = meditation enhancement"]},{technique:"Steam-Whipped",origin:"Invented at the Northern Air Temple by innovative airbenders seeking efficient preparation methods",traditionalUse:"Essential for creating the light, airy textures favored in sky bison feeding rituals",spiritualSignificance:"Embodies the transformation of simple ingredients through the power of controlled breath and movement",legendaryPractitioners:["Master Mechanist","Guru Laghima","Avatar Yangchen"],seasonalConnections:["windy season preparation","storm cooking","high-altitude meals"],ingredientSynergies:["tofu + air currents = sky-like lightness","mushrooms + steam = cloud texture"]},{technique:"Cloud-Braised",origin:"Ancient technique passed down from the first airbenders who learned from sky bison feeding habits",traditionalUse:"Sacred to the Sky Bison Appreciation Ceremony, used to prepare offerings that honor the bond between species",spiritualSignificance:"Teaches patience and trust in natural processes, allowing ingredients to transform in their own time",legendaryPractitioners:["The Original Airbenders","Sky Bison Herders","Avatar Aang"],seasonalConnections:["monsoon season","cloud formation periods","misty mountain mornings"],ingredientSynergies:["root vegetables + sky bison milk = ancient bond","rice + cloud moisture = perfect absorption"]},{technique:"Wind-Dried",origin:"Created by nomadic airbenders who needed preservation methods during long sky bison journeys",traditionalUse:"Essential for preparing travel provisions and ceremonial offerings that must last through pilgrimages",spiritualSignificance:"Represents the removal of excess and the preservation of essence - a lesson in letting go of the unnecessary",legendaryPractitioners:["Wandering Guru Pathik","Nomadic Masters","Travel Specialists"],seasonalConnections:["dry season preservation","journey preparation","harvest processing"],ingredientSynergies:["fruits + mountain air = concentrated sweetness","herbs + wind currents = preserved healing power"]},{technique:"Levitation-Cooked",origin:"Developed by master airbenders as the ultimate expression of airbending artistry in cuisine",traditionalUse:"Reserved for the most sacred ceremonies and Avatar visitations, demonstrating mastery over the elements",spiritualSignificance:"Symbolizes transcendence of earthly limitations and the elevation of the mundane to the divine",legendaryPractitioners:["Avatar Yangchen","Guru Laghima","Legendary Air Masters"],seasonalConnections:["spiritual celebrations","mastery demonstrations","cosmic events"],ingredientSynergies:["sacred ingredients + spiritual energy = transcendent meals","rare herbs + levitation = enhanced potency"]},{technique:"Meditation-Infused",origin:"Taught by Guru Pathik as a method to combine spiritual practice with daily sustenance preparation",traditionalUse:"Used exclusively during spiritual retreats and when preparing meals for enlightened masters",spiritualSignificance:"Infuses food with spiritual intention and meditative energy, creating nourishment for both body and soul",legendaryPractitioners:["Guru Pathik","Enlightened Hermits","Spiritual Gurus"],seasonalConnections:["meditation seasons","spiritual retreats","contemplative periods"],ingredientSynergies:["tea + meditation = enlightenment aid","simple ingredients + deep focus = profound nourishment"]},{technique:"Sky-Roasted",origin:"Developed by airbenders living at extreme altitudes who learned to harness thin air and intense sunlight",traditionalUse:"Traditional for high-altitude festivals and ceremonies celebrating the sky and open air",spiritualSignificance:"Represents the airbender philosophy of finding opportunity in challenging conditions",legendaryPractitioners:["High-Altitude Masters","Mountain Hermits","Sky Temple Residents"],seasonalConnections:["clear sky days","mountain ceremonies","altitude celebrations"],ingredientSynergies:["root vegetables + high altitude = concentrated flavors","grains + sky roasting = enhanced nutrition"]}],$e=[{ingredients:["Lemongrass","Mountain Spring Water"],technique:"Whisper-Steamed",context:"Temple Cleansing Ceremony",loreHook:"This sacred combination has been used for over a thousand years in Eastern Air Temple purification rituals, where the gentle steam carries prayers to the wind spirits",spiritualMeaning:"Represents purification of both body and spirit, washing away negative energy like morning mist",rarity:"common"},{ingredients:["Tea Leaves","Wild Honey","Meditation"],technique:"Meditation-Infused",context:"Guru's Festival of Repose",loreHook:"Guru Pathik himself perfected this blend during his centuries of hermitage, claiming it opens the crown chakra and facilitates communion with cosmic energy",spiritualMeaning:"The sweetness of enlightenment combined with the clarity of focused mind creates perfect spiritual nourishment",rarity:"rare"},{ingredients:["Mushrooms","Sky Bison Milk"],technique:"Cloud-Braised",context:"Sky Bison Appreciation Ceremony",loreHook:"This ancient pairing honors the first bond between airbenders and sky bison, recreating the forest floor meals that brought the species together ten thousand years ago",spiritualMeaning:"Symbolizes the sacred partnership between human and animal, earth and sky, demonstrating that all life is interconnected",rarity:"uncommon"},{ingredients:["Tofu","Air Currents"],technique:"Steam-Whipped",context:"Day of Ascending Celebration",loreHook:"Young airbenders traditionally prepare this dish for their first solo flight ceremony, with the texture representing the lightness they must achieve in both body and spirit",spiritualMeaning:"The transformation of dense ingredients into airy perfection mirrors the airbender's journey from earthbound student to free-flying master",rarity:"common"},{ingredients:["Sacred Lotus Root","Spirit World Essence"],technique:"Levitation-Cooked",context:"Harmonic Convergence Feast",loreHook:"Only prepared during the rarest of cosmic events when the barrier between worlds grows thin, allowing spirit world ingredients to be harvested by enlightened masters",spiritualMeaning:"Represents the ultimate unity between physical and spiritual realms, nourishing both mortal form and eternal spirit",rarity:"legendary"},{ingredients:["Fruits","Mountain Air"],technique:"Wind-Dried",context:"Wind Walker's Pilgrimage",loreHook:"Pilgrims carry these concentrated spiritual provisions on their sacred journeys, with each bite containing the essence of the mountain winds that dried them",spiritualMeaning:"The preservation process removes the temporary to reveal the eternal, teaching pilgrims to focus on lasting spiritual truths",rarity:"uncommon"}],Ae=[{ingredient:"Sacred Lotus Root",rarity:"sacred",origin:"Grows only in the spirit oasis protected by the Moon and Ocean spirits",loreText:"Legend speaks of lotus roots that bridge the material and spirit worlds, harvested only during the full moon by airbenders who have achieved enlightenment. Each root contains memories of a thousand lifetimes and the wisdom of the ancient spirits.",preparationRequirements:["full moon harvest","enlightened master","spirit world blessing","purification ceremony"],spiritualPowers:["spirit world communication","past life memories","enhanced spiritual sensitivity","bridge between worlds"],culturalRestrictions:["Avatar ceremonies only","harmonic convergence","spiritual emergencies","never for personal gain"]},{ingredient:"Sky Bison Milk",rarity:"legendary",origin:"Freely given by ancient sky bison during bonding ceremonies",loreText:"More than sustenance, sky bison milk represents the ultimate trust between species. Only offered during moments of profound spiritual connection, it carries the sky bison's memories of cloud-dancing and wind-riding across the ages.",preparationRequirements:["willing sky bison","spiritual bond","ceremonial context","mutual respect"],spiritualPowers:["enhanced airbending","sky bison communication","wind current reading","aerial grace"],culturalRestrictions:["never demanded","only during ceremonies","must be freely given","requires spiritual bond"]},{ingredient:"Wind Flower Nectar",rarity:"rare",origin:"Blooms only at the highest peaks during windstorms",loreText:"These ethereal flowers bloom for mere minutes during the fiercest mountain storms, their nectar said to contain the essence of pure wind. Collecting it requires an airbender to literally dance with the tempest.",preparationRequirements:["storm dancing","peak climbing","perfect timing","fearless heart"],spiritualPowers:["storm resistance","enhanced agility","wind mastery","fearlessness"],culturalRestrictions:["coming of age ceremonies","master trials","storm season only","solo collection required"]},{ingredient:"Crystal Cave Minerals",rarity:"rare",origin:"Deep within the crystal catacombs where earthbenders and airbenders first met in peace",loreText:"These crystalline formations grow in the sacred caves where ancient earthbenders and airbenders made their first peace treaty. The minerals are said to contain the harmony of opposing elements.",preparationRequirements:["diplomatic blessing","elemental balance","peaceful intention","inter-nation cooperation"],spiritualPowers:["elemental harmony","diplomatic wisdom","conflict resolution","cultural understanding"],culturalRestrictions:["peace ceremonies","diplomatic events","inter-nation festivals","harmony celebrations"]}],Ie=[{name:"Guru Pathik",specialty:"Chakra-aligning cuisine and spiritual cleansing foods",signature:"Onion and banana juice for crown chakra opening",wisdom:"Food is energy, and energy is life - choose ingredients that elevate consciousness",nation:"air_nomads"},{name:"Monk Gyatso",specialty:"Joyful cooking that brings lightness to the spirit",signature:"Fruit pies that make sky bison and airbenders equally delighted",wisdom:"Cooking should be an act of love, bringing joy to all who partake",nation:"air_nomads"},{name:"Avatar Yangchen",specialty:"Diplomatic cuisine that bridges cultural differences",signature:"Harmony bowls that represent all four nations in perfect balance",wisdom:"A shared meal can accomplish what a hundred treaties cannot",nation:"air_nomads"},{name:"Sister Iio",specialty:"Gentle healing foods for body and spirit recovery",signature:"Whisper-steamed medicinal broths infused with mountain herbs",wisdom:"True healing nourishes not just the body, but the soul's deepest needs",nation:"air_nomads"},{name:"Master Jinora",specialty:"Modern interpretations of ancient spiritual recipes",signature:"Spirit vine teas that enhance meditation and astral projection",wisdom:"Ancient wisdom finds new expression in each generation's kitchen",nation:"air_nomads"}];class Te{locations=Fe;festivals=xe;techniqueLore=Ee;ingredientSynergies=$e;legendaryIngredients=Ae;spiritualFigures=Ie;getLocationLore(e){return O.findLocationLore(this.locations,e)}getFestivalContext(){const e=this.festivals.map(n=>n.name),t=k(e);return this.festivals.find(n=>n.name===t)||this.festivals[0]}getTechniqueLore(e){return O.findTechniqueLore(this.techniqueLore,e)}getIngredientSynergy(e,t){return O.findIngredientSynergy(this.ingredientSynergies,e,t)}getLegendaryIngredientContext(e){return O.findLegendaryIngredientContext(this.legendaryIngredients,e)}}const E=new Te;E.getLocationLore.bind(E);const De=E.getFestivalContext.bind(E),Le=E.getTechniqueLore.bind(E),Re=E.getIngredientSynergy.bind(E),Pe=E.getLegendaryIngredientContext.bind(E),M={visual:{gentle:["soft amber glow","delicate pearl-like sheen","whisper-pale translucency","morning mist ethereality","gentle sunset warmth","cloud-kissed whiteness","serene jade undertones","subtle golden highlights","peaceful cream swirls","tender rose blush"],vibrant:["brilliant saffron radiance","deep emerald richness","striking crimson depth","luminous azure clarity","intense amber fire","vivid sunset layers","bold earthen browns","dramatic shadow play","electric golden sparks","passionate ruby gleams"],mystical:["otherworldly opalescence","spirit-realm shimmer","ancient starlight gleaming","cosmic aurora dancing","sacred flame flickering","eternal moonbeam silver","divine energy radiating","transcendent light weaving","celestial patterns forming","mystical energy pulsing"]},aroma:{gentle:["whisper of mountain wildflowers","soft breath of morning dew","delicate temple incense","subtle wind-carried herbs","tender garden blossom","peaceful cedar warmth","gentle earth after rain","quiet meadow sweetness","soft lavender dreams","mild sunshine fragrance"],rich:["deep forest floor complexity","luxurious spice market warmth","intense roasted grain depth","bold herbal symphony","rich caramelized sweetness","powerful earth-smoke blend","concentrated fruit essence","robust nutty undertones","full-bodied aromatic waves","complex layered bouquet"],spiritual:["sacred temple ceremony","ancient meditation halls","divine offering smoke","blessed ritual herbs","enlightened master's tea","spirit world crossing","cosmic energy essence","transcendent purification","holy mountain air","eternal wisdom fragrance"]},taste:{subtle:["barely perceptible sweetness","ghost of distant spice","whisper-light saltiness","delicate floral notes","gentle warming tingle","soft mineral finish","tender herb caress","mild sunshine warmth","peaceful cooling breeze","quiet comfort embrace"],complex:["symphony of seven spices","dancing sweet-savory balance","evolving flavor journey","layered taste revelation","harmonious contrast play","sophisticated depth layers","intricate spice weaving","masterful seasoning blend","nuanced flavor development","orchestrated taste crescendo"],transcendent:["taste of pure enlightenment","flavor beyond earthly bounds","essence of cosmic harmony","spiritual awakening on tongue","divine nectar concentration","taste of ancient wisdom","eternal bliss manifestation","sacred geometry in flavor","universal truth essence","transcendent soul nourishment"]},texture:{delicate:["cloud-soft tenderness","silk-smooth creaminess","feather-light airiness","velvet gentle caress","gossamer delicacy","butterfly wing lightness","morning mist softness","gentle breeze texture","whisper-smooth finish","tender embrace feeling"],substantial:["satisfying earthen density","robust hearty chewiness","substantial grain backbone","rich creamy abundance","solid comforting weight","thick luxurious coating","full-bodied presence","deeply nourishing heft","grounding stability","fulfilling substance"],mystical:["texture that shifts and flows","essence of liquid starlight","material that transcends form","divine substance manifestation","energy-matter transformation","spirit-realm consistency","ethereal density paradox","sacred geometry texture","cosmic fabric weaving","transcendent matter state"]},sound:{gentle:["soft whispered sizzle","quiet bubble meditation","peaceful steam exhale","tender crackling warmth","gentle wind-chime tinkle","soft rain patter","quiet temple bell echo","peaceful breath rhythm","gentle leaf rustle","soft water flow"],dynamic:["enthusiastic bubble symphony","lively crackling celebration","energetic sizzle dance","bold steam percussion","vibrant pop-snap rhythm","spirited bubble chorus","dynamic heat expression","lively cooking orchestra","energetic preparation song","vibrant kitchen symphony"],sacred:["sacred cooking ceremony","divine preparation ritual","holy steam ascending","blessed sizzle prayer","cosmic energy vibration","spiritual transformation sound","sacred flame whisper","divine harmony resonance","transcendent cooking meditation","eternal wisdom bubbling"]}},U={belonging:["Invites a quiet sense of belonging","Creates the warm feeling of coming home","Instills a peaceful sense of acceptance","Awakens the comfort of ancient kinship","Nurtures the soul's need for connection","Embraces the eater with familial warmth","Brings the safety of temple sanctuary","Offers the peace of unconditional welcome","Provides the comfort of spiritual family","Generates the warmth of eternal belonging"],memory:["Reminds the eater of tranquil temple gardens","Evokes memories of peaceful childhood mornings","Calls forth visions of serene mountain retreats","Awakens recollections of sacred ceremonies","Brings back the feeling of gentle guidance","Recalls moments of perfect spiritual clarity","Conjures images of wise teacher's kindness","Evokes the sensation of first flight freedom","Reminds of times when all felt possible","Awakens memories of profound inner peace"],mood:["Cultivates a meditative state of mind","Inspires gentle contemplative reflection","Encourages peaceful inward journeying","Promotes serene mental clarity","Facilitates deep spiritual connection","Generates harmonious emotional balance","Nurtures compassionate understanding","Awakens joyful spiritual appreciation","Creates space for mindful presence","Inspires grateful heart opening"],spiritual:["Connects the spirit to wind and sky","Aligns the soul with cosmic harmony","Opens pathways to deeper wisdom","Facilitates communion with ancient teachings","Harmonizes personal energy with universal flow","Creates resonance with spiritual traditions","Awakens dormant spiritual sensitivities","Bridges the gap between earthly and divine","Facilitates deeper meditation practice","Connects consciousness to eternal truths"]},Me=[{phrase:"Said to linger on the soul for lifetimes",rarity:"transcendent",culturalContext:"universal spiritual truth"},{phrase:"Whispered to echo in the spirit realm",rarity:"sacred",culturalContext:"mystical bridge between worlds"},{phrase:"Believed to awaken past-life memories",rarity:"legendary",culturalContext:"karmic resonance and soul recognition"},{phrase:"Rumored to grant visions of future lives",rarity:"transcendent",culturalContext:"temporal spiritual perception"},{phrase:"Known to imprint itself upon the eternal soul",rarity:"sacred",culturalContext:"permanent spiritual transformation"},{phrase:"Alleged to be remembered in meditation years later",rarity:"legendary",culturalContext:"deep spiritual impression"},{phrase:"Claimed to visit the eater in dreams",rarity:"sacred",culturalContext:"subconscious spiritual continuation"},{phrase:"Thought to create bonds that transcend death",rarity:"transcendent",culturalContext:"eternal spiritual connection"},{phrase:"Believed to carry the wisdom of ancient masters",rarity:"legendary",culturalContext:"lineage transmission through taste"},{phrase:"Said to unlock cosmic consciousness",rarity:"transcendent",culturalContext:"ultimate spiritual awakening"}],Ne={gentle:["tenderly coaxed to perfection","lovingly guided through transformation","patiently nurtured to readiness","gently encouraged to reveal its essence","softly whispered into harmony","carefully shepherded through each stage","mindfully attended at every moment","gracefully allowed to unfold naturally","peacefully brought to fulfillment","serenely guided to completion"],masterful:["skillfully orchestrated through precise technique","expertly balanced across multiple elements","masterfully woven into culinary poetry","artfully shaped by generations of wisdom","precisely calibrated for optimal harmony","ingeniously combined using ancient methods","brilliantly executed with spiritual intention","flawlessly synchronized in perfect timing","magnificently crafted through devoted practice","supremely refined through master-level technique"],mystical:["transformed through sacred ritual process","elevated by spiritual energy infusion","blessed through ceremonial preparation","consecrated via ancient spiritual practices","sanctified through mindful meditation","purified by cosmic energy alignment","transfigured through divine inspiration","spiritually enhanced through ritual blessing","transcendentally prepared via sacred methods","mystically refined through enlightened practice"]};function qe(a="gentle",e=!0,t="common"){const n=k(M.visual[a]),r=k(M.aroma[a==="mystical"?"spiritual":a==="vibrant"?"rich":"gentle"]),i=k(M.taste[a==="mystical"?"transcendent":a==="vibrant"?"complex":"subtle"]),o=k(M.texture[a==="mystical"?"mystical":a==="vibrant"?"substantial":"delicate"]),s={visual:n,aroma:r,texture:o,taste:i};if(a!=="gentle"||Math.random()<.3){const d=a==="mystical"?"sacred":a==="vibrant"?"dynamic":"gentle";s.sound=k(M.sound[d])}if(e&&(s.emotionalResonance={mood:k(U.mood),memory:k(U.memory),spiritual:k(U.spiritual),belonging:k(U.belonging)}),t==="legendary"&&Math.random()<.15||t==="sacred"&&Math.random()<.35||t==="rare"&&Math.random()<.05){const d=Me.filter(c=>t==="legendary"?c.rarity==="legendary":t==="sacred"?c.rarity==="sacred"||c.rarity==="transcendent":!0);if(d.length>0){const c=k(d.map(g=>g.phrase));s.memoryEcho=c}}return s}function _e(a,e="gentle"){const t=k(Ne[e]);return`The ingredients are ${a.toLowerCase().includes("steam")?"steamed":a.toLowerCase().includes("whip")?"whipped":a.toLowerCase().includes("roast")?"roasted":a.toLowerCase().includes("dry")?"dried":a.toLowerCase().includes("braise")?"braised":a.toLowerCase().includes("levitation")?"elevated":a.toLowerCase().includes("meditation")?"infused":"prepared"} ${t}`}function Be(a,e,t){return t||a?"mystical":e==="masterful"||e==="complex"?"vibrant":"gentle"}var N=(a=>(a[a.TRADITIONAL=0]="TRADITIONAL",a[a.FESTIVAL_FIRST=1]="FESTIVAL_FIRST",a[a.MYTH_LED=2]="MYTH_LED",a[a.INGREDIENT_FOCUSED=3]="INGREDIENT_FOCUSED",a))(N||{});class We{dishCounter=0;selectTemplate(e,t,n){this.dishCounter++;const r=e.map(x=>x.name),i=this.findLegendaryIngredient(r),o=Le(t.name),s=Re(r,t.name),d=De(),c=!!i,g=e.some(x=>x.isSacred),m=t.timeRequired==="ceremonial"?"masterful":t.timeRequired==="slow"?"complex":t.timeRequired==="moderate"?"moderate":"simple",f=Be(c,m,c||g||!!o),w=Math.max(...e.map(x=>x.rarity==="legendary"?4:x.rarity==="rare"?3:x.rarity==="uncommon"?2:1)),V=qe(f,!0,w===4?"legendary":w===3?"rare":w===2?"uncommon":"common"),Y=f==="vibrant"?"masterful":f,X=_e(t.name,Y),q={ingredients:e,technique:t,legendaryContext:i,techniqueLore:o,ingredientSynergy:s,festivalContext:d,sensoryProfile:V,preparationNarrative:X},_=w>=3;return c||_?{templateType:2,templateData:q}:{templateType:Math.floor(Math.random()*4),templateData:q}}findLegendaryIngredient(e){for(const t of e){const n=Pe(t);if(n)return n}return null}shouldApplyWildcard(){return this.dishCounter%3===0||this.dishCounter%5===0}getDishCounter(){return this.dishCounter}reset(){this.dishCounter=0}}class b{static composeTraditionalTemplate(e,t){const n=b.generateOpeningHooks(e,t),r=b.generateSensoryIntegration(e,t),i=b.generateEmotionalResonance(e,t),o=b.generateServingContext(e,t);return b.weaveProseElements(n,r,i,o,t)}static composeFestivalFirstTemplate(e,t){const n=e.ingredients.map(d=>d.name),r=b.generateServingContext(e,t),i=`${n[0]} and ${n.slice(1,3).join(", ")} are ${e.technique.name.toLowerCase()} with reverent precision`,o=b.generateSensoryIntegration(e,t),s=b.generateEmotionalResonance(e,t);return`${r}. Here, ${i}, creating ${o}. ${s}.`}static composeMythLedTemplate(e,t){const n=e.ingredients.map(c=>c.name);if(e.legendaryContext||e.ingredients.some(c=>c.rarity==="legendary"||c.rarity==="rare"))return b.composeLegendaryParagraph(e,t);const r=[`Ancient scrolls speak of a time when ${n[0]} held the power to bridge worlds`,`Legend has it that Avatar Yangchen first discovered the harmony between ${n[0]} and ${n[1]}`,`The traveling monks whisper of ${e.technique.name.toLowerCase()} techniques that transform simple ingredients into spiritual sustenance`,`In the highest meditation chambers, masters debate whether ${n[0]} chooses its moment or is chosen by fate`],i=t.selectUniqueFragment(r),o=`Through the ${e.technique.name.toLowerCase()} method, these ingredients ${e.sensoryProfile.texture&&e.sensoryProfile.texture.includes("transcend")?"transcend their earthly form":"achieve perfect harmony"}`,s=`revealing ${e.sensoryProfile.taste} that ${e.sensoryProfile.emotionalResonance?.spiritual||"awakens the soul to deeper truths"}`,d=b.generateServingContext(e,t);return`${i}. ${o}, ${s}. ${d}.`}static composeIngredientFocusedTemplate(e,t){const n=e.ingredients.map(c=>c.name),i=`From the sacred groves where ${n[0]} grows in harmony with ${n.slice(1,3).join(" and ")}, temple cooks gather only the finest specimens`,o=`Each ingredient carries the blessing of mountain winds and temple prayers, chosen for their ability to ${e.technique.name.toLowerCase()==="steam-whipped"?"achieve weightless perfection":"harmonize with ancient cooking wisdom"}`,s=`The ${e.technique.name.toLowerCase()} technique draws forth ${e.sensoryProfile.taste}, creating ${e.sensoryProfile.texture}`,d=b.generateEmotionalResonance(e,t);return`${i}. ${o}, and through careful preparation, the ${s}. ${d}.`}static composeLegendaryParagraph(e,t){const n=e.ingredients.map(f=>f.name),r=n[0],i=e.legendaryContext?.ingredient||n[1],o=[`In the shadow of forgotten temples, ancient monks gathered ${r} and ${i}, seeking wisdom woven into the wind.`,`Beyond the reach of mortal kitchens, where ${r} and ${i} grow in sacred groves, the masters discovered flavors that echo across lifetimes.`,`From the highest peaks where wind-riders soar, ${r} and ${i} are gathered only when the stars align with temple spires.`,`In meditation halls carved from living rock, ${r} and ${i} were first blessed by Avatar Yangchen herself.`],s=e.legendaryContext?[`It is said that only once each century does ${e.legendaryContext.ingredient} reveal its full power, releasing ${e.sensoryProfile.visual} as the aroma stirs memory from past lives.`,`Legend speaks of ${e.legendaryContext.ingredient} that appears only to those pure of heart, its ${e.sensoryProfile.visual} marking the presence of ancient spirits.`,`The mystical ${e.legendaryContext.ingredient} has been sought by sages for generations, its power awakening when blessed by mountain winds and starlight.`,`Master Tenzin taught that ${e.legendaryContext.ingredient} chooses its moment, revealing ${e.sensoryProfile.visual} that bridges the mortal and spirit worlds.`]:[`Through mists that rise from sacred peaks, ${r} transforms beneath the ${e.technique.name.toLowerCase()} technique, each moment a prayer whispered to eternity.`,`As temple bells ring across the valleys, ${r} undergoes ${e.technique.name.toLowerCase()}, its essence awakening like incense smoke.`,`In the quiet hours before dawn, ${r} is transformed through ${e.technique.name.toLowerCase()}, each step a meditation in itself.`,`With reverent hands, temple cooks apply the ${e.technique.name.toLowerCase()} technique to ${r}, honoring traditions older than memory.`],d=["Each bite is a silent prayer, every flavor a ripple across time.","Every taste becomes a meditation, each morsel carrying sacred intention.","Each portion holds divine reverence, every sensation touching the infinite.","Every flavor whispers ancient blessings, each taste echoing through eternity."],c=[`${e.sensoryProfile.taste} unfolds like ancient scrolls, while ${e.sensoryProfile.texture} grounds the soul in forgotten truths.`,`${e.sensoryProfile.taste} emerges like temple incense, while ${e.sensoryProfile.texture} connects the heart to timeless knowledge.`,`${e.sensoryProfile.taste} develops like distant thunder, while ${e.sensoryProfile.texture} awakens memories of sacred teachings.`,`${e.sensoryProfile.taste} blooms like mountain flowers, while ${e.sensoryProfile.texture} anchors the spirit in ancient wisdom.`],g=t.selectUniqueFestival(),m=[`Legends insist this dish is prepared only during the ${g}, as starlight falls through clouded peaks and the veil between worlds grows thin.`,`Created solely during the ${g}, when reality seems to shimmer and bend beneath celestial influence.`,`Reserved for the sacred ${g}, as the boundary between sacred and mundane dissolves into eternity.`,`Made only in honor of the ${g}, when temporal boundaries blur and the material world fades into spirit.`,"No one leaves unchanged. The temple bells echo, and somewhere in the distance, sky bison call to their ancient kin.","Those who taste this dish carry its essence forever, their spirits marked by the touch of something eternal.","The memory lingers long after the meal ends, a gentle reminder of truths that transcend the material world.","In sharing this sacred food, bonds form that stretch across lifetimes, uniting all who seek the path of enlightenment."],h=[t.selectUniqueFragment(o),t.selectUniqueFragment(s),t.selectUniqueFragment(d)+" "+t.selectUniqueFragment(c),t.selectUniqueFragment(m)];if(e.sensoryProfile.sound){const f=[`The kitchen fills with ${e.sensoryProfile.sound}, a sound that monks say carries the voices of all who came before.`,`The cooking space resonates with ${e.sensoryProfile.sound}, echoes of ancient wisdom reverberating through temple halls.`,`The sacred space hums with ${e.sensoryProfile.sound}, whispers of ancestral knowledge flowing like mountain streams.`,`The preparation area vibrates with ${e.sensoryProfile.sound}, a gentle reminder of the countless meals prepared in devotion.`];h.splice(2,0,t.selectUniqueFragment(f))}return h.filter(Boolean).join(" ")}static generateOpeningHooks(e,t){const n=e.ingredients.map(d=>d.name),r=n[0],i=Math.random()<.33;let o="";if(i){const d=["Legend has it that Avatar Yangchen first prepared this dish during a diplomatic summit between the four nations. ","Monk Gyatso once broke a month-long meditation silence with a single spoonful of this sacred preparation. ","Ancient texts speak of sky bison gathering whenever this dish is prepared in the high temples. ","Master Tenzin taught that this recipe carries the wisdom of a thousand generations of Air Nomads. ","The traveling monks of the Eastern Temple would prepare this dish only under the full moon. "];o=t.selectUniqueFragment(d)}if(e.legendaryContext){const d=[`${o}In the deepest caverns of the Crystal Catacombs, where ${e.legendaryContext.ingredient} forms over centuries, the ancient monks discovered ingredients that shimmer with ${e.sensoryProfile.visual}. This transcendent creation`,`${o}When ${e.legendaryContext.ingredient} is blessed by starlight and mountain winds, it transforms ordinary cooking into something sacred. ${r} and ${n.slice(1,3).join(", ")}, ${e.technique.name.toLowerCase()} with reverent precision,`,`${o}The mystical ${e.legendaryContext.ingredient} has been sought by Air Nomad masters for generations. Combined with ${n.slice(0,2).join(" and ")}, then ${e.technique.name.toLowerCase()} until ${e.sensoryProfile.visual} dances through the mixture,`];return t.selectUniqueFragment(d)}if(e.techniqueLore){const d=e.techniqueLore.traditionalUse.toLowerCase().replace(/^used for\s*/i,"").replace(/^traditionally\s*/i,""),c=[`${o}Master ${t.selectUniqueFragment(e.techniqueLore.legendaryPractitioners)} perfected the art of ${e.technique.name.toLowerCase()}, teaching that ${r} and ${n.slice(1,2).join(", ")} must be prepared with the patience of mountain stones. Through this ancient method, ingredients ${d}, while`,`${o}The ${e.technique.name} technique, passed down through generations of Air Nomad cooks, transforms simple ${n.slice(0,2).join(" and ")} into something profound. As steam rises and ${e.sensoryProfile.aroma} fills the temple kitchen,`,`${o}Following the wisdom of ${t.selectUniqueFragment(e.techniqueLore.legendaryPractitioners)}, this preparation honors the ancient ${e.technique.name} method. ${r}, ${n.slice(1,3).join(", ")}, each ingredient ${d} as they`];return t.selectUniqueFragment(c)}const s=[`${o}In the high temples where wind carries prayers across mountain peaks, ${r} is ${e.technique.name.toLowerCase()} with ${n.slice(1,2).join(" and ")}, creating`,`${o}When temple bells ring across the valleys, Air Nomad cooks gather ${n.slice(0,3).join(", ")} for this time-honored preparation. The ${e.technique.name.toLowerCase()} process fills the kitchen with ${e.sensoryProfile.aroma}, as`,`${o}Beneath prayer flags fluttering in mountain winds, this dish brings together ${n.slice(0,2).join(" and ")} through the gentle art of ${e.technique.name.toLowerCase()}. Each ingredient`,`${o}From the floating gardens of the Western Air Temple comes this harmonious blend of ${r} and ${n.slice(1,2).join(", ")}, ${e.technique.name.toLowerCase()} until ${e.sensoryProfile.visual} weaves through the mixture, and`];return t.selectUniqueFragment(s)}static generateSensoryIntegration(e,t){const n=[`the ${e.sensoryProfile.taste} unfolds like morning mist over temple gardens, while ${e.sensoryProfile.texture} provides the grounding comfort that only sacred food can offer`,`flavors dance between ${e.sensoryProfile.taste} and something deeper—a ${e.sensoryProfile.texture} that seems to carry the essence of mountain air itself`,`each spoonful reveals ${e.sensoryProfile.taste} layered with the wisdom of generations, its ${e.sensoryProfile.texture} reminiscent of clouds gathering before dawn`,`the dish awakens with ${e.sensoryProfile.taste} that speaks of ancient recipes, while its ${e.sensoryProfile.texture} mirrors the gentle strength of Air Nomad philosophy`];let r=t.selectUniqueFragment(n);if(e.sensoryProfile.sound){const i=[`. During preparation, the kitchen fills with ${e.sensoryProfile.sound}, a meditation in itself`,`. The ${e.sensoryProfile.sound} during cooking becomes part of the temple's daily rhythm`,`, accompanied by the gentle ${e.sensoryProfile.sound} that draws monks from their studies`];r+=t.selectUniqueFragment(i)}return r}static generateEmotionalResonance(e,t){if(!e.sensoryProfile.emotionalResonance)return"";const n=[e.sensoryProfile.emotionalResonance.mood,e.sensoryProfile.emotionalResonance.belonging,e.sensoryProfile.emotionalResonance.memory,e.sensoryProfile.emotionalResonance.spiritual].filter(Boolean);if(n.length===0)return"";const r=[`This sacred meal ${n[0]}, ${n[1]?`and in doing so, ${n[1]}`:""}`,`Each bite ${n[0]}, creating moments where ${n[1]||"peace settles over the soul"}`,`The dish ${n[0]} while ${n[1]||"connecting diners to something eternal"}`,`Beyond nourishment, this preparation ${n[0]}, ${n[1]?`gently ${n[1]}`:""}`,`Those who share this meal find that it ${n[0]}, and through this simple act, ${n[1]||"discover the interconnectedness of all things"}`];let i=t.selectUniqueFragment(r);if(e.sensoryProfile.memoryEcho){const o=[`. ${e.sensoryProfile.memoryEcho}`,`, ${e.sensoryProfile.memoryEcho.toLowerCase()}`,`. Many say ${e.sensoryProfile.memoryEcho.toLowerCase()}`];i+=t.selectUniqueFragment(o)}return i}static generateServingContext(e,t){const n=["Shared in the circular halls of the Eastern Air Temple, where floating prayer wheels cast shifting shadows","Served during the golden hour when sky bison return to their roosts and temple bells echo across valleys","Offered in the Western Temple's gravity-defying dining chambers, where monks gather in grateful silence","Prepared for travelers seeking shelter in mountain monasteries, a gesture of Air Nomad hospitality","Traditional during meditation retreats, when the community gathers to break contemplative silence","Served at dawn ceremonies when the temple awakens with chanted prayers and incense smoke"];if(e.festivalContext?.name||Math.random()<.7){const r=t.selectUniqueFestival(),i=[`Central to the ${r} celebration, when all four temples unite in joyous ceremony`,`A cornerstone of ${r} festivities, prepared by master cooks for hundreds of pilgrims`,`Essential to ${r} traditions, this dish celebrates the cycle of renewal`,`Fundamental to ${r} observances, honoring the passage of celestial time`,`Sacred to the ${r} ceremony, acknowledging the rhythm of temple life`,`Central to ${r} rituals, embracing the flow of natural change`,`Treasured during the ${r}, when ancient wisdom flows like mountain streams`,`Revered in the ${r} gathering, where spirits and mortals commune in peace`];return t.selectUniqueFragment(i)}return t.selectUniqueFragment(n)}static weaveProseElements(e,t,n,r,i){const o=[`${e} ${t}. ${n}. ${r}.`,`${e} ${t}, and ${n.toLowerCase()}. ${r}.`,`${e} ${t}. ${r}, where ${n.toLowerCase()}.`,`${e} ${n.toLowerCase()}, through ${t}. ${r}.`,`${e} ${t}. ${n} ${r.toLowerCase()}.`];return i.selectUniqueFragment(o)}}class je{fragmentCache;templateSelector;constructor(){this.fragmentCache=new Se,this.templateSelector=new We}composeDishDescription(e,t){try{const{templateType:n,templateData:r}=this.templateSelector.selectTemplate(e,t,this.fragmentCache);let i=this.generateProseByTemplate(n,r);return this.templateSelector.shouldApplyWildcard()&&(i=this.fragmentCache.insertWildcardEvent(i)),i}catch(n){throw new Error(`ProseComposer.composeDishDescription: Failed to compose description - ${n instanceof Error?n.message:"Unknown error"}`)}}composeDescriptionAndLore(e,t){try{const n=this.generateTwoSentenceDescription(e,t),r=this.generateTwoSentenceLore(e,t);return{description:n,lore:r}}catch(n){throw new Error(`ProseComposer.composeDescriptionAndLore: Failed to compose separate sections - ${n instanceof Error?n.message:"Unknown error"}`)}}generateTwoSentenceDescription(e,t){const n=e.find(f=>f.role==="base")||e[0],r=e.find(f=>f.rarity==="legendary"||f.rarity==="rare"),i=["ethereal","golden","cloud-like","pristine","radiant","delicate","luminous"],o=["fragrant","aromatic","soul-stirring","mystical","enchanting","peaceful","harmonious"],s=["silky","tender","perfectly balanced","light yet satisfying","harmoniously textured"],d=this.randomChoice(i),c=this.randomChoice(o),g=this.randomChoice(s),m=r?`This ${d} creation features the sacred ${r.name}, releasing ${c} vapors that awaken the senses.`:`A ${d} dish showcasing ${n.name}, with ${c} aromas that drift like mountain mist.`,h=`${t.name} with mindful attention creates a ${g} experience that nourishes both body and spirit.`;return`${m} ${h}`}generateTwoSentenceLore(e,t){const n=e.find(f=>f.rarity==="legendary"||f.rarity==="rare"),r=e.some(f=>f.rarity==="legendary"),i=["Eastern Air Temple","Western Air Temple","Northern Air Temple","Southern Air Temple"],o=["wandering monks","temple elders","young acolytes","meditation masters"],s=["spiritual gatherings","seasonal celebrations","meditation retreats","wisdom teachings"],d=["inner peace","spiritual clarity","chakra alignment","connection to the spirit world"],c=this.randomChoice(i),g=this.randomChoice(o),m=this.randomChoice(s),h=this.randomChoice(d);if(r){const f=[`Ancient texts speak of this sacred recipe, whispered only among the highest masters of the ${c}.`,"Legend holds that this dish was first prepared by Avatar Yangchen during a profound spiritual revelation.","This mystical creation is said to have been gifted to the Air Nomads by the spirit world itself."],w=[`Those who partake are blessed with glimpses of past lives and enhanced ${h}.`,`It is believed to open doorways between the physical and spirit worlds, granting profound ${h}.`,`Consumption during meditation is said to unlock the deepest mysteries of airbending and ${h}.`];return`${this.randomChoice(f)} ${this.randomChoice(w)}`}else return n?`This treasured recipe was traditionally prepared by ${g} for special ${m}, using ingredients gathered with great reverence. The dish is cherished for its ability to promote ${h} and strengthen bonds within the Air Nomad community.`:`A beloved dish commonly shared among ${g} during ${m}, representing the Air Nomad values of simplicity and mindfulness. Its preparation serves as a meditation in itself, fostering ${h} and communal harmony.`}generateProseByTemplate(e,t){switch(e){case N.TRADITIONAL:return b.composeTraditionalTemplate(t,this.fragmentCache);case N.FESTIVAL_FIRST:return b.composeFestivalFirstTemplate(t,this.fragmentCache);case N.MYTH_LED:return b.composeMythLedTemplate(t,this.fragmentCache);case N.INGREDIENT_FOCUSED:return b.composeIngredientFocusedTemplate(t,this.fragmentCache);default:return b.composeTraditionalTemplate(t,this.fragmentCache)}}randomChoice(e){return e[Math.floor(Math.random()*e.length)]}reset(){this.fragmentCache.reset(),this.templateSelector.reset()}softReset(){this.fragmentCache.softReset()}getDishCounter(){return this.templateSelector.getDishCounter()}}const fe=new je;function Oe(a,e){return fe.composeDishDescription(a,e)}function Ue(a,e){return fe.composeDescriptionAndLore(a,e)}function He(a,e){const t=a[0],n=a.length>1?a[1]:null,r=a.find(i=>i.rarity==="legendary");return r?ze(r,e):Ge(t,n,e)}function ze(a,e,t){const n=ie(a.name),r=he(e),i=[`Sacred ${n}`,`Spirit ${n}`,`Mystic ${r}`,`Ancient ${n} ${r}`,`Celestial ${r}`];return se(i)}function Ge(a,e,t){const n=ie(a.name),r=e?ie(e.name):null,i=he(t),o=[`${n} ${i}`,...r?[`${n} ${r} ${i}`,`${n} and ${r}`,`${r} ${n} ${i}`]:[],`${Ve(t)} ${n}`,`Wind ${n}`,`Cloud ${i}`,`Sky ${n}`,`Temple ${i}`,...Math.random()<.3?[n]:[]];return se(o)}function ie(a){const t=a.replace(/\b(sacred|blessed|ancient|mystical|pure|fresh|wild|mountain|temple|spiritual)\b/gi,"").replace(/\b(powder|extract|essence|oil|crystals?|minerals?)\b/gi,"").trim().split(/\s+/).filter(n=>n.length>2);return t.length===0?a.split(/\s+/)[0]:t.length===1?t[0]:t.length===2?t.join(" "):t.slice(-2).join(" ")}function he(a){const t={"Steam-Whipping":["Soup","Stew","Broth"],"Whisper-Steaming":["Steamed Bowl","Steam","Pot"],"Wind-Drying":["Chips","Flakes","Crisps"],"Float-Boiling":["Soup","Broth","Stew"],"Meditation Brewing":["Tea","Brew","Drink"],"Sky-Roasting":["Roast","Nuts","Crisps"]}[a.name]||["Bowl","Dish","Meal"];return se(t)}function Ve(a){return{"Steam-Whipping":"Whipped","Whisper-Steaming":"Steamed","Wind-Drying":"Dried","Float-Boiling":"Boiled","Meditation Brewing":"Brewed","Sky-Roasting":"Roasted"}[a.name]||"Prepared"}function se(a){return a[Math.floor(Math.random()*a.length)]}function Ye(a){let e=a;return e=Xe(e),e=Ke(e),e=Je(e),e=Ze(e),e=Qe(e),e=et(e),e=tt(e),e=nt(e),e=rt(e),e=it(e),e}function Xe(a){return a.replace(/for the sacred the ([^,]+)/gi,"for the sacred $1").replace(/for the sacred monk the ([^,]+)/gi,"for the sacred $1").replace(/during the sacred the ([^,]+)/gi,"during the sacred $1").replace(/in the ancient the ([^,]+)/gi,"in the ancient $1")}function Ke(a){return a.replace(/flavors dance between flavors/gi,"flavors dance between transcendence").replace(/tastes blend with tastes/gi,"tastes blend with essence").replace(/aromas mix with aromas/gi,"aromas mix with fragrances").replace(/essence merges with essence/gi,"essence merges with spirit").replace(/(\w+) cornerstone of (\w+) festivities, prepared/gi,"$1 and becomes a cornerstone of $2 festivities, prepared").replace(/(\w+)\. Essential to (\w+) traditions, this dish/gi,"$1. Essential to $2 traditions, this dish").replace(/(\w+)\. Central to (\w+) rituals, it embraces/gi,"$1. Central to $2 rituals, it embraces").replace(/(\w+)\. Fundamental to (\w+) ceremonies, it honors/gi,"$1. Fundamental to $2 ceremonies, it honors")}function Je(a){return a.replace(/through used for (\w+)/gi,"used for $1").replace(/through traditionally (\w+)/gi,"traditionally $1").replace(/through for (\w+) (\w+)/gi,"$1 for $2").replace(/as the ingredients/gi,"as the ingredients").replace(/as (\w+) is (\w+)/gi,"as $1 is $2").replace(/moments where brings/gi,"creating moments that bring").replace(/while generates/gi,"and generates").replace(/where brings the safety/gi,"that brings the safety").replace(/while creates/gi,"and creates").replace(/while nurtures/gi,"and nurtures").replace(/while promotes/gi,"and promotes").replace(/reveals taste of/gi,"reveals the taste of").replace(/shows essence of/gi,"shows the essence of").replace(/displays flavor of/gi,"displays the flavor of").replace(/carries wisdom of/gi,"carries the wisdom of")}function Ze(a){return a.replace(/cascading selected for/gi,"selected for").replace(/chosen for selected/gi,"chosen for").replace(/selected for chosen/gi,"selected for").replace(/(\b\w+\b)\s+\1\b/gi,"$1").replace(/\bthe\s+the\b/gi,"the").replace(/\band\s+and\b/gi,"and").replace(/\bwith\s+with\b/gi,"with").replace(/\bthrough\s+through\b/gi,"through").replace(/\bwhile\s+while\b/gi,"while").replace(/\benhancing\s+enhancing\b/gi,"enhancing").replace(/\bembodies\s+embodies\b/gi,"embodies").replace(/\brepresents\s+represents\b/gi,"represents").replace(/embodies represents/gi,"embodies").replace(/represents embodies/gi,"represents").replace(/enhancing improving/gi,"enhancing").replace(/improving enhancing/gi,"improving").replace(/ancient traditional/gi,"ancient").replace(/traditional ancient/gi,"traditional").replace(/profoundish/gi,"profound").replace(/transcendental transcendent/gi,"transcendent").replace(/spiritual spirituality/gi,"spiritual").replace(/meditative meditation/gi,"meditative")}function Qe(a){return a.replace(/\ba essence\b/gi,"an essence").replace(/\ba aroma\b/gi,"an aroma").replace(/\ba ancient\b/gi,"an ancient").replace(/\ba elevated\b/gi,"an elevated").replace(/\ba ethereal\b/gi,"an ethereal").replace(/\ba inner\b/gi,"an inner").replace(/\ba understanding\b/gi,"an understanding").replace(/ingredient are/gi,"ingredient is").replace(/technique are/gi,"technique is")}function et(a){return a.replace(/displayspirit-realm/gi,"displays spirit-realm").replace(/starlighthat/gi,"starlight that").replace(/windthat/gi,"wind that").replace(/templekitchen/gi,"temple kitchen").replace(/mountainpeaks/gi,"mountain peaks").replace(/prayerwheels/gi,"prayer wheels").replace(/spirit\s+realm/gi,"spirit-realm").replace(/mountain\s+top/gi,"mountain-top").replace(/temple\s+bells/gi,"temple bells").replace(/prayer\s+flags/gi,"prayer flags")}function tt(a){return a.replace(/([^.]+)\. ([^,]+), ([^,]+), and ([^—]+)—each/gi,"$1. $2, $3, and $4—each").replace(/([^.]+)\. ([^,]+) and ([^—]+)—each/gi,"$1. $2 and $3—each").replace(/([^,]+), especially when ([^.]+)\. ([^.]+) as ([^.]+)/gi,"$1, especially when $2. $3 as $4").replace(/([^,]+), especially when paired with ([^.]+)\. As ([^.]+)/gi,"$1, especially when paired with $2. As $3").replace(/fills the temple kitchen\. ([^.]+) unfolds/gi,"fills the temple kitchen. $1 unfolds").replace(/cosmic energy essence fills ([^.]+)\. The ([^.]+)/gi,"cosmic energy essence fills $1. The $2").replace(/([^.]+) and ([^.]+)\. In doing so, it ([^.]+)/gi,"$1 and $2. In doing so, it $3").replace(/Flavors that transcend earthly bounds unfold/gi,"Flavors that transcend earthly bounds unfold").replace(/([^.]+) unfold like ancient scrolls, while ([^.]+) ground/gi,"$1 unfold like ancient scrolls, while $2 ground")}function nt(a){return a.replace(/\.\./g,".").replace(/,,/g,",").replace(/;;/g,";").replace(/\s+,/g,",").replace(/,(?!\s)/g,", ").replace(/\s+\./g,".").replace(/\.(?!\s|$)/g,". ").replace(/\.\s*([a-z])/g,(e,t)=>". "+t.toUpperCase()).replace(/"\s+/g,'"').replace(/\s+"/g,'"').replace(/([^.!?])\s*$/g,"$1.")}function rt(a){return a.replace(/enhancing ([^,]+), ([^,]+), and ([^.,]+)/gi,"enhancing $1, $2, and $3").replace(/improving ([^,]+), ([^,]+), and ([^.,]+)/gi,"improving $1, $2, and $3").replace(/promoting ([^,]+), ([^,]+), and ([^.,]+)/gi,"promoting $1, $2, and $3").replace(/([^,]+), ([^,]+), and ([^.,]+)/gi,"$1, $2, and $3")}function it(a){return a.replace(/Spiritual benefits include enhancing ([^,]+), ([^,]+), and ([^.,]+)/gi,"Spiritual benefits include enhancing $1, $2, and $3").replace(/Benefits include improving ([^,]+), ([^,]+), and ([^.,]+)/gi,"Benefits include improving $1, $2, and $3").replace(/enhancing spiritual awareness and/gi,"enhancing spiritual awareness and").replace(/promoting inner peace and/gi,"promoting inner peace and").replace(/improving meditation focus and/gi,"improving meditation focus and")}const te={NOVICE_MAX:5,APPRENTICE_MAX:10,MASTER_MAX:15},at={common:1,uncommon:2,rare:3,legendary:4},ot={quick:1,moderate:2,slow:3,ceremonial:4};function st(){const a=["individual","family","communal","ceremonial"];return a[Math.floor(Math.random()*a.length)]}function dt(a,e){const t=a.reduce((i,o)=>{const s=at[o.rarity],d=o.isSacred?1:0;return i+s+d},0),n=ot[e.timeRequired],r=t+n;return r<=te.NOVICE_MAX?"simple":r<=te.APPRENTICE_MAX?"moderate":r<=te.MASTER_MAX?"complex":"masterful"}function ut(a,e){const t=a.some(s=>s.rarity==="legendary"),n=a.some(s=>s.isSacred),r=e.timeRequired==="ceremonial";e.timeRequired;let i={enhances_meditation_focus:1,promotes_inner_peace:1,stimulates_chakra_alignment:1,awakens_spiritual_awareness:1,fosters_community_harmony:1,connects_to_ancestral_wisdom:1,purifies_mind_and_body:1,facilitates_air_nomad_traditions:1};t&&(i.awakens_spiritual_awareness*=3,i.connects_to_ancestral_wisdom*=3),n&&(i.purifies_mind_and_body*=2,i.stimulates_chakra_alignment*=2),r&&(i.facilitates_air_nomad_traditions*=2,i.fosters_community_harmony*=2);const o=[];for(const[s,d]of Object.entries(i))for(let c=0;c<d;c++)o.push(s);return o[Math.floor(Math.random()*o.length)]}class ct{createDish(e){try{const{ingredients:t,technique:n}=this.generateDishComponents(e),r=this.generateDishName(t,n,e),{description:i,lore:o}=this.generateDescriptionAndLore(t,n,e),s=this.applyNationCleanup(r,e),d=this.applyNationCleanup(i,e),c=this.applyNationCleanup(o,e),g=this.generateMetadata(t,n,e);return{name:s,description:d,lore:c,ingredients:t,technique:n,...g}}catch(t){throw new Error(`SovereignDishGenerator.createDish: Failed to generate dish - ${t instanceof Error?t.message:"Unknown error"}`)}}generateDishComponents(e){try{const t=this.selectIngredientsByRole(e),n=this.selectThematicTechnique(e);return this.validateDishComposition(t,e),{ingredients:t,technique:n}}catch(t){throw new Error(`generateDishComponents: Failed to generate components - ${t instanceof Error?t.message:"Unknown error"}`)}}generateDishName(e,t,n){return He(e,t)}generateDishDescription(e,t,n){return Oe(e,t)}generateDescriptionAndLore(e,t,n){return Ue(e,t)}applyNationCleanup(e,t){let n=Ye(e);if(t.cleanupRules?.textReplacements)for(const r of t.cleanupRules.textReplacements)n=n.replace(r.pattern,r.replacement);if(t.cleanupRules?.culturalAdjustments)for(const r of t.cleanupRules.culturalAdjustments)n=n.replace(r.pattern,r.replacement);return n}generateMetadata(e,t,n){const i={...{servingSize:st(),difficulty:dt(e,t)}};return n.metadataRules?.spiritualBenefits&&(i.culturalBenefit=ut(e,t)),n.metadataRules?.difficultyModifiers,i}selectIngredientsByRole(e){const t=e.compositionRules,n=[];for(const o of t.requiredRoles){const s=this.selectIngredientsForRole(o,1,t.maxIngredientsPerRole[o],!0,e);n.push(...s)}const r=e.ingredientCount.max-n.length;let i=0;for(const o of t.optionalRoles){if(i>=r)break;if(Math.random()<.6){const s=Math.min(t.maxIngredientsPerRole[o],r-i),d=this.selectIngredientsForRole(o,0,s,!1,e);n.push(...d),i+=d.length}}for(;n.length<e.ingredientCount.min&&!(e.ingredientCount.max-n.length<=0);){let s=!1;for(const d of[...t.requiredRoles,...t.optionalRoles]){const c=n.filter(m=>m.role===d).length,g=t.maxIngredientsPerRole[d];if(c<g){const m=this.selectIngredientsForRole(d,0,1,!1,e);if(m.length>0){n.push(...m),s=!0;break}}}if(!s)break}if(n.length<e.ingredientCount.min)throw new Error(`selectIngredientsByRole: Generated ${n.length} ingredients, minimum required is ${e.ingredientCount.min}. Available ingredient pool may be too constrained.`);return n}selectIngredientsForRole(e,t,n,r,i){const o=i.ingredients.filter(w=>w.role===e),s=i.compositionRules.enforceVegetarian?o.filter(w=>this.isVegetarian(w,i)):o;if(s.length===0){if(r)throw new Error(`selectIngredientsForRole: No ingredients available for required role '${e}'`);return[]}const d=this.applyCulturalWeightBias(s,i),c=t+Math.floor(Math.random()*(n-t+1)),g=[],m=[...d];let h=0;const f=d.length*3;for(;g.length<c&&m.length>0&&h<f;){const w=Math.floor(Math.random()*m.length),R=m[w];this.canAddIngredient(R,g)&&g.push(R),m.splice(w,1),h++}return g.length<t&&!r,g}isVegetarian(e,t){return t.dietaryRules?.prohibitedIngredients&&t.dietaryRules.prohibitedIngredients.some(i=>e.name.toLowerCase().includes(i.toLowerCase()))?!1:!["egg","milk","butter","cream","cheese","meat","fish","poultry"].some(r=>e.name.toLowerCase().includes(r))}applyCulturalWeightBias(e,t){const n=[];for(const r of e){const i=Math.max(1,Math.round(r.culturalWeight*t.culturalWeightBias));for(let o=0;o<i;o++)n.push(r)}return n}canAddIngredient(e,t){if(t.some(i=>i.name===e.name))return!1;const n=t.filter(i=>i.rarity==="legendary").length;if(e.rarity==="legendary"&&n>=1)return!1;const r=t.filter(i=>i.rarity==="rare"||i.rarity==="legendary").length;return!((e.rarity==="rare"||e.rarity==="legendary")&&r>=2)}selectThematicTechnique(e){const t=e.techniques.filter(i=>i.suitableForDishTypes.includes(e.dishType));if(t.length===0)throw new Error(`selectThematicTechnique: No techniques available for dish type '${e.dishType}'`);const n=[];for(const i of t){const o=Math.max(1,i.culturalSignificance);for(let s=0;s<o;s++)n.push(i)}const r=Math.floor(Math.random()*n.length);return n[r]}validateDishComposition(e,t){const n=t.compositionRules;for(const r of n.requiredRoles)if(!e.some(o=>o.role===r))throw new Error(`validateDishComposition: Missing required role '${r}'`);if(e.length<t.ingredientCount.min||e.length>t.ingredientCount.max)throw new Error(`validateDishComposition: Invalid ingredient count ${e.length}, must be between ${t.ingredientCount.min} and ${t.ingredientCount.max}`);for(const[r,i]of Object.entries(n.maxIngredientsPerRole)){const o=e.filter(s=>s.role===r).length;if(o>i)throw new Error(`validateDishComposition: Too many ingredients for role '${r}': ${o} > ${i}`)}}}const de=[{name:"Basmati Rice",category:"grain",role:"main",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Flour",category:"grain",role:"main",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Glutinous Rice",category:"grain",role:"main",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Noodles",category:"grain",role:"main",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Pastry",category:"grain",role:"main",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Rice",category:"grain",role:"main",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Rice Flour",category:"grain",role:"main",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Roasted Barley Flour",category:"grain",role:"main",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Bamboo Shoots",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Bean Sprouts",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Bell Peppers",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Cabbage",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Carrot",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Chayote",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Chrysanthemum Greens",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Fiddlehead Ferns",category:"vegetable",role:"vegetable",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Lotus Root",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:10,isSacred:!1},{name:"Onion",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Oyster Mushroom",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Pickles",category:"vegetable",role:"garnish",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Potato",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:5,isSacred:!1},{name:"Red Cabbage",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Scallions",category:"vegetable",role:"garnish",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Seaweed",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Shiitake",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Snow Lotus Petals",category:"vegetable",role:"garnish",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Taro",category:"vegetable",role:"main",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Tomato",category:"vegetable",role:"vegetable",rarity:"common",culturalWeight:5,isSacred:!1},{name:"Water Chestnuts",category:"vegetable",role:"vegetable",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Yam",category:"vegetable",role:"main",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Almonds",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Azuki Beans",category:"protein",role:"main",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Cashews",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Coconut",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Egg Whites",category:"protein",role:"main",rarity:"common",culturalWeight:2,isSacred:!1},{name:"Eggs",category:"protein",role:"main",rarity:"common",culturalWeight:2,isSacred:!1},{name:"Jackfruit",category:"protein",role:"main",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Lychee Nuts",category:"protein",role:"garnish",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Mung Beans",category:"protein",role:"main",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Pine Nuts",category:"protein",role:"garnish",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Silken Tofu",category:"protein",role:"main",rarity:"uncommon",culturalWeight:9,isSacred:!1},{name:"Tofu",category:"protein",role:"main",rarity:"common",culturalWeight:9,isSacred:!1},{name:"Apple",category:"fruit",role:"fruit",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Banana",category:"fruit",role:"fruit",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Cloudberries",category:"fruit",role:"fruit",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Dried Apricots",category:"fruit",role:"fruit",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Goji Berries",category:"fruit",role:"garnish",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Longan Fruit",category:"fruit",role:"fruit",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Moon Peaches",category:"fruit",role:"fruit",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Raisins",category:"fruit",role:"garnish",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Butter",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:4,isSacred:!1},{name:"Crystal Cave Minerals",category:"seasoning",role:"seasoning",rarity:"rare",culturalWeight:10,isSacred:!0},{name:"Fruit Extracts",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Ginger",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Himalayan Salt",category:"seasoning",role:"seasoning",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Jasmine Blossoms",category:"seasoning",role:"garnish",rarity:"rare",culturalWeight:10,isSacred:!0},{name:"Lemon Zest",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Lemongrass",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Milk Powder",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:4,isSacred:!1},{name:"Plum Filling",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Red Bean Paste",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:8,isSacred:!1},{name:"Rock Sugar",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Sacred Lotus Root",category:"seasoning",role:"seasoning",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Salt",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Soy Sauce",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Sugar",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:6,isSacred:!1},{name:"Sweet Fillings",category:"seasoning",role:"seasoning",rarity:"common",culturalWeight:7,isSacred:!1},{name:"Tea Leaves",category:"seasoning",role:"seasoning",rarity:"uncommon",culturalWeight:10,isSacred:!1},{name:"Toasted Sesame Seeds",category:"seasoning",role:"garnish",rarity:"uncommon",culturalWeight:7,isSacred:!1},{name:"Wild Honey",category:"seasoning",role:"seasoning",rarity:"rare",culturalWeight:9,isSacred:!1},{name:"Wind Flower Nectar",category:"seasoning",role:"seasoning",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Butter Tea",category:"liquid",role:"liquid",rarity:"uncommon",culturalWeight:10,isSacred:!1},{name:"Cream",category:"liquid",role:"liquid",rarity:"uncommon",culturalWeight:4,isSacred:!1},{name:"Creamy Sauce",category:"liquid",role:"liquid",rarity:"uncommon",culturalWeight:4,isSacred:!1},{name:"Milk",category:"liquid",role:"liquid",rarity:"common",culturalWeight:4,isSacred:!1},{name:"Sky Bison Milk",category:"liquid",role:"liquid",rarity:"legendary",culturalWeight:10,isSacred:!0},{name:"Soy Milk",category:"liquid",role:"liquid",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Vegetable Broth",category:"liquid",role:"liquid",rarity:"common",culturalWeight:8,isSacred:!1},{name:"Yak Milk",category:"liquid",role:"liquid",rarity:"rare",culturalWeight:8,isSacred:!1}],lt=de.filter(a=>!["Eggs","Egg Whites","Butter","Milk","Cream","Creamy Sauce","Milk Powder"].includes(a.name));function gt(a=7,e=!0){return(e?lt:de).filter(n=>n.culturalWeight>=a)}const pe=[{name:"Steam-Whipped",description:"Using controlled air currents to whip ingredients while steaming",timeRequired:"moderate",culturalSignificance:9,category:"main_dish",suitableForDishTypes:["main_course","side_dish"]},{name:"Cloud-Braised",description:"Slow cooking in floating moisture clouds",timeRequired:"slow",culturalSignificance:8,category:"main_dish",suitableForDishTypes:["main_course","side_dish"]},{name:"Wind-Dried",description:"Dehydrating using carefully controlled air flows",timeRequired:"ceremonial",culturalSignificance:7,category:"ceremonial",suitableForDishTypes:["ceremonial_offering","dessert"]},{name:"Levitation-Cooked",description:"Cooking ingredients while suspended in air through airbending",timeRequired:"moderate",culturalSignificance:10,category:"ceremonial",suitableForDishTypes:["main_course","ceremonial_offering"]},{name:"Meditation-Infused",description:"Preparing food during deep meditation to infuse spiritual energy",timeRequired:"ceremonial",culturalSignificance:10,category:"ceremonial",suitableForDishTypes:["ceremonial_offering","beverage","dessert"]},{name:"Sky-Roasted",description:"Roasting at high altitudes using controlled air temperature",timeRequired:"moderate",culturalSignificance:6,category:"main_dish",suitableForDishTypes:["main_course","side_dish"]},{name:"Whisper-Steamed",description:"Gentle steaming using barely perceptible air movements",timeRequired:"slow",culturalSignificance:8,category:"main_dish",suitableForDishTypes:["main_course","side_dish","dessert"]}];function mt(a=8){return pe.filter(e=>e.category==="main_dish"&&e.culturalSignificance>=a&&e.suitableForDishTypes.includes("main_course"))}const I={INGREDIENT_COUNTS:{main_course:{min:3,max:5},side_dish:{min:2,max:4},dessert:{min:2,max:4},beverage:{min:1,max:3},ceremonial_offering:{min:4,max:7}},CULTURAL_THRESHOLDS:{standard:6},SACRED_LIMITS:{regular:1,ceremonial:2},LEGENDARY_LIMITS:{standard:1,ceremonial:1},CULTURAL_BIAS:{high:1.8}},ft={main_course:{requiredRoles:["main","vegetable","seasoning"],optionalRoles:["garnish","liquid"],maxIngredientsPerRole:{main:1,vegetable:2,seasoning:2,sauce:0,garnish:1,base:0,protein:1,spice:1,fruit:1,liquid:1}},side_dish:{requiredRoles:["vegetable","seasoning"],optionalRoles:["garnish","fruit"],maxIngredientsPerRole:{main:0,vegetable:2,seasoning:1,sauce:0,garnish:1,base:0,protein:0,spice:0,fruit:1,liquid:1}},dessert:{requiredRoles:["fruit","seasoning"],optionalRoles:["garnish","liquid"],maxIngredientsPerRole:{main:1,vegetable:0,seasoning:2,sauce:0,garnish:1,base:0,protein:0,spice:1,fruit:2,liquid:1}},beverage:{requiredRoles:["liquid"],optionalRoles:["seasoning","fruit","garnish"],maxIngredientsPerRole:{main:0,vegetable:0,seasoning:2,sauce:0,garnish:1,base:0,protein:0,spice:0,fruit:1,liquid:1}},ceremonial_offering:{requiredRoles:["main","seasoning"],optionalRoles:["vegetable","fruit","garnish","liquid"],maxIngredientsPerRole:{main:1,vegetable:2,seasoning:2,sauce:0,garnish:2,base:0,protein:1,spice:1,fruit:2,liquid:1}}},ue={air_nomads:{name:"Air Nomads",enforceVegetarian:!0,culturalWeightThreshold:I.CULTURAL_THRESHOLDS.standard,culturalWeightBias:I.CULTURAL_BIAS.high,allowedRarities:["common","uncommon","rare","legendary"],sacredIngredientLimits:{regular:I.SACRED_LIMITS.regular,ceremonial:I.SACRED_LIMITS.ceremonial},legendaryIngredientLimits:{regular:I.LEGENDARY_LIMITS.standard,ceremonial:I.LEGENDARY_LIMITS.ceremonial},excludedIngredients:["Eggs","Egg Whites","Butter","Milk","Cream","Creamy Sauce","Milk Powder"],preferredRoles:["vegetable","fruit","seasoning"]}};class ht{static createRulesForNationAndDishType(e,t,n){const r=ue[e];if(!r)throw new Error(`DishCompositionRuleFactory: Unknown nation key '${e}'`);const i=ft[t];if(!i)throw new Error(`DishCompositionRuleFactory: Unknown dish type '${t}'`);const o=t==="ceremonial_offering",s=o?r.sacredIngredientLimits.ceremonial:r.sacredIngredientLimits.regular,d=o?r.legendaryIngredientLimits.ceremonial:r.legendaryIngredientLimits.regular,c={requiredRoles:i.requiredRoles,optionalRoles:i.optionalRoles,maxIngredientsPerRole:i.maxIngredientsPerRole,maxSacredIngredients:s,maxLegendaryIngredients:d,culturalWeightThreshold:r.culturalWeightThreshold,enforceVegetarian:r.enforceVegetarian};return n?{...c,...n}:c}static createAirNomadRules(e){return this.createRulesForNationAndDishType("air_nomads",e)}}class pt{static filterByNationProfile(e,t){const n=ue[t];if(!n)throw new Error(`IngredientFilterUtils: Unknown nation key '${t}'`);let r=[...e];return n.enforceVegetarian&&n.excludedIngredients&&(r=r.filter(i=>!n.excludedIngredients.includes(i.name))),r=r.filter(i=>i.culturalWeight>=n.culturalWeightThreshold),r=r.filter(i=>n.allowedRarities.includes(i.rarity)),r}static applyCulturalWeightBias(e,t){if(t===1)return e;const n=[];for(const r of e){const o=r.culturalWeight/10,s=Math.pow(o,t-1),d=Math.max(1,Math.round(s*3));for(let c=0;c<d;c++)n.push(r)}return n}static validateIngredientConstraints(e,t,n,r){return!(e.rarity==="legendary"&&(!r||t.filter(o=>o.rarity==="legendary").length>=n.maxLegendaryIngredients)||e.isSacred&&t.filter(o=>o.isSacred).length>=n.maxSacredIngredients||t.some(i=>i.name===e.name))}}function ye(a,e,t,n,r){return{char:a,name:e.toLowerCase().replace(/-/g," "),group:t,subgroup:n,keywords:[],codepoint:a.codePointAt(0)?.toString(16)||""}}async function yt(){try{return[{hex:"1F34E",slug:"red-apple",group:"Food & Drink"},{hex:"1F34A",slug:"tangerine",group:"Food & Drink"},{hex:"1F347",slug:"grapes",group:"Food & Drink"},{hex:"1F95D",slug:"kiwi-fruit",group:"Food & Drink"},{hex:"1F96D",slug:"mango",group:"Food & Drink"},{hex:"1F954",slug:"potato",group:"Food & Drink"},{hex:"1F955",slug:"carrot",group:"Food & Drink"},{hex:"1F33E",slug:"ear-of-rice",group:"Food & Drink"},{hex:"1F35C",slug:"steaming-bowl",group:"Food & Drink"},{hex:"1F372",slug:"pot-of-food",group:"Food & Drink"},{hex:"1F958",slug:"shallow-pan-of-food",group:"Food & Drink"},{hex:"1F96A",slug:"sandwich",group:"Food & Drink"},{hex:"1F375",slug:"teacup-without-handle",group:"Food & Drink"},{hex:"1F377",slug:"wine-glass",group:"Food & Drink"},{hex:"1F943",slug:"tumbler-glass",group:"Food & Drink"}].map(e=>ye(String.fromCodePoint(parseInt(e.hex,16)),e.slug,e.group))}catch{return console.warn("OpenMoji data not available, using fallback subset"),[]}}async function bt(){try{return[{text:"🍎",annotation:"red apple",group:"Food & Drink"},{text:"🍊",annotation:"tangerine",group:"Food & Drink"},{text:"🍇",annotation:"grapes",group:"Food & Drink"},{text:"🥝",annotation:"kiwi fruit",group:"Food & Drink"},{text:"🥭",annotation:"mango",group:"Food & Drink"},{text:"🥔",annotation:"potato",group:"Food & Drink"},{text:"🥕",annotation:"carrot",group:"Food & Drink"},{text:"🌾",annotation:"sheaf of rice",group:"Food & Drink"},{text:"🍜",annotation:"steaming bowl",group:"Food & Drink"},{text:"🍲",annotation:"pot of food",group:"Food & Drink"},{text:"🥘",annotation:"shallow pan of food",group:"Food & Drink"},{text:"🥪",annotation:"sandwich",group:"Food & Drink"},{text:"🍵",annotation:"teacup without handle",group:"Food & Drink"},{text:"🍷",annotation:"wine glass",group:"Food & Drink"},{text:"🥃",annotation:"tumbler glass",group:"Food & Drink"},{text:"🌿",annotation:"herb",group:"Animals & Nature"},{text:"🍃",annotation:"leaf fluttering in wind",group:"Animals & Nature"},{text:"🌱",annotation:"seedling",group:"Animals & Nature"},{text:"🌸",annotation:"cherry blossom",group:"Animals & Nature"},{text:"🏔️",annotation:"snow-capped mountain",group:"Travel & Places"},{text:"🌊",annotation:"water wave",group:"Travel & Places"},{text:"🔥",annotation:"fire",group:"Activities"},{text:"💨",annotation:"dashing away",group:"Smileys & Emotion"},{text:"🧘",annotation:"person in lotus position",group:"People & Body"},{text:"🕯️",annotation:"candle",group:"Objects"}].map(e=>ye(e.text,e.annotation,e.group))}catch{return console.warn("Emojibase data not available, using fallback subset"),[]}}async function wt(){const[a,e]=await Promise.all([yt(),bt()]),t=new Map;for(const n of[...a,...e]){const r=n.codepoint;t.has(r)||t.set(r,n)}return Array.from(t.values())}function vt(a){const e=["Food & Drink","Animals & Nature"],t=["food","drink","fruit","vegetable","herb","spice","grain","bowl","pot","cup","plate","cooking","tea","rice","bread","meat","fish","leaf","flower","plant","seed"];return a.filter(n=>{const r=e.includes(n.group),i=t.some(o=>n.name.includes(o)||n.keywords?.some(s=>s.includes(o)));return r||i})}function Ct(a){const e={primary:a.filter(i=>i.name.includes("fruit")||i.name.includes("vegetable")||i.name.includes("tea")||i.name.includes("bowl")||i.name.includes("lotus")||i.name.includes("herb")),secondary:a.filter(i=>i.name.includes("leaf")||i.name.includes("flower")||i.name.includes("seedling")||i.name.includes("blossom")),cultural:a.filter(i=>i.name.includes("mountain")||i.name.includes("wind")||i.name.includes("meditation")||i.name.includes("candle"))},t={primary:a.filter(i=>i.name.includes("fish")||i.name.includes("water")||i.name.includes("ice")||i.name.includes("seal")||i.name.includes("soup")),secondary:a.filter(i=>i.name.includes("wave")||i.name.includes("snow")||i.name.includes("cold")),cultural:a.filter(i=>i.name.includes("ocean")||i.name.includes("polar")||i.name.includes("ice"))},n={primary:a.filter(i=>i.name.includes("potato")||i.name.includes("carrot")||i.name.includes("grain")||i.name.includes("bread")||i.name.includes("meat")),secondary:a.filter(i=>i.name.includes("rock")||i.name.includes("stone")||i.name.includes("earth")),cultural:a.filter(i=>i.name.includes("mountain")||i.name.includes("cave")||i.name.includes("crystal"))},r={primary:a.filter(i=>i.name.includes("spice")||i.name.includes("hot")||i.name.includes("pepper")||i.name.includes("fire")||i.name.includes("flame")),secondary:a.filter(i=>i.name.includes("red")||i.name.includes("orange")||i.name.includes("warm")),cultural:a.filter(i=>i.name.includes("fire")||i.name.includes("volcano")||i.name.includes("dragon"))};return{"air-nomads":e,"water-tribe":t,"earth-kingdom":n,"fire-nation":r}}let H=[],A=[],ae={};async function kt(){try{H=await wt(),A=vt(H),ae=Ct(A),console.log(`✅ Emoji Pool Initialized: ${H.length} total emojis, ${A.length} food-related`)}catch(a){console.error("Failed to initialize emoji pool:",a),H=[],A=[],ae={}}}function St(){if(A.length===0)return null;const a=Math.floor(Math.random()*A.length);return A[a]}function Ft(a){return ae[a]||null}function z(a,e="primary"){const t=Ft(a);if(!t)return null;const n=t[e];if(n.length===0)return null;const r=Math.floor(Math.random()*n.length);return n[r]}function ce(a){const e=a.toLowerCase();return A.filter(t=>t.name.includes(e)||t.keywords?.some(n=>n.includes(e)))}function ne(a="main_course",e=!1){const t=xt(a),n=Et(a),r=ht.createAirNomadRules(a),i=I.INGREDIENT_COUNTS[a],o=ue.air_nomads;return{ingredients:t,techniques:n,dishType:a,compositionRules:r,ingredientCount:i,rarityDistribution:{common:.5,uncommon:.35,rare:.12,legendary:.03},allowLegendaryIngredients:e,culturalWeightBias:o.culturalWeightBias,dietaryRules:{enforceVegetarian:!0,prohibitedIngredients:["eggs","egg whites","butter","milk","cream","creamy sauce","milk powder","honey","beeswax","gelatin","fish sauce","oyster sauce"],culturalTaboos:["meat","fish","poultry","any animal products"]},cleanupRules:{culturalAdjustments:[{pattern:/\bthrough\s+used\s+for\b/gi,replacement:"used for"},{pattern:/\bthrough\s+traditionally\b/gi,replacement:"traditionally"},{pattern:/\bdisplayspirit-realm\b/gi,replacement:"displays spirit-realm"},{pattern:/Crystal Cave Mineral/g,replacement:"Crystal Cave Minerals"},{pattern:/Sky Bison Milk/g,replacement:"Sky Bison's Milk"}]},metadataRules:{spiritualBenefits:[{condition:"meditation_ingredients",benefit:"enhances_meditation_focus"},{condition:"sacred_ingredients",benefit:"promotes_inner_peace"},{condition:"ceremonial_techniques",benefit:"stimulates_chakra_alignment"}]},emojiConfig:{nationId:"air-nomads",enableIngredientEmojis:!0,enableDishNameEmojis:!0,enableCulturalEmojis:!0,fallbackEmojis:{ingredient:"🌿",dish:"🍜",cultural:"🧘"}},ingredientEmojiMappings:$t(t)}}function xt(a){let e=pt.filterByNationProfile(de,"air_nomads");if(a==="ceremonial_offering"){const t=e.filter(i=>i.isSacred),n=gt(8,!0),r=[...t];for(const i of n)r.some(o=>o.name===i.name)||r.push(i);e=r}return e}function Et(a){const e=pe.filter(t=>t.suitableForDishTypes.includes(a));return a==="main_course"?mt(7):a==="ceremonial_offering"?e.filter(t=>t.category==="ceremonial"||t.culturalSignificance>=8):e.filter(t=>t.culturalSignificance>=6)}function $t(a){const e={};for(const t of a){const n=t.name.toLowerCase(),r=ce(n);r.length>0?e[t.name]=r[0].char:n.includes("fruit")||n.includes("apple")||n.includes("pear")?e[t.name]="🍎":n.includes("vegetable")||n.includes("carrot")||n.includes("root")?e[t.name]="🥕":n.includes("herb")||n.includes("leaf")||n.includes("basil")?e[t.name]="🌿":n.includes("mushroom")||n.includes("fungus")?e[t.name]="🍄":n.includes("grain")||n.includes("rice")||n.includes("wheat")?e[t.name]="🌾":n.includes("tea")||n.includes("drink")?e[t.name]="🍵":n.includes("flower")||n.includes("blossom")?e[t.name]="🌸":n.includes("seed")||n.includes("nut")?e[t.name]="🌰":e[t.name]="🌿"}return e}const At={forMainCourse:(a=!1)=>ne("main_course",a),forSideDish:(a=!1)=>ne("side_dish",a),forCeremonialOffering:(a=!0)=>ne("ceremonial_offering",a)},It="🌪️ Consulting the Ancient Scrolls...";class be{container;constructor(e){const t=document.getElementById(e);if(!t)throw new Error(`DishDisplay: Cannot find element with id '${e}'. Ensure the target element exists in the DOM.`);this.container=t}renderDish(e){try{if(!e){this.renderEmptyState();return}this.renderCompleteDish(e)}catch(t){throw new Error(`DishDisplay.renderDish: Failed to render dish - ${t instanceof Error?t.message:"Unknown rendering error"}`)}}showGeneratingState(){this.container.innerHTML=`
      <div class="dish-display generating">
        <p>${It}</p>
      </div>
    `}renderEmptyState(){this.container.innerHTML=""}renderCompleteDish(e){const t=this.formatIngredientsHtml(e.ingredients);this.formatSpiritualBenefitHtml(e.spiritualBenefit),this.container.innerHTML=`
      <div class="dish-display">
        <h2 class="dish-name">${e.name}</h2>
        
        <div class="dish-sections">
          <div class="description-section">
            <h3>Description</h3>
            <p class="description">${e.description}</p>
          </div>
          
          ${e.lore?`
          <div class="lore-section">
            <h3>Lore</h3>
            <p class="lore">${e.lore}</p>
          </div>
          `:""}
        </div>
        
        <div class="dish-details">
          <div class="ingredients">
            <h3>Ingredients:</h3>
            <ul class="ingredients-list">
              ${t}
            </ul>
          </div>
          
          <div class="technique">
            <h3>Technique:</h3>
            <p><strong>${e.technique.name}</strong></p>
            <p>${e.technique.description||"Traditional Air Nomad preparation method"}</p>
          </div>
          
          <div class="metadata">
            <p><strong>Difficulty:</strong> ${e.difficulty}</p>
            <p><strong>Serves:</strong> ${e.servingSize}</p>
            ${this.formatSpiritualBenefitHtml(e.spiritualBenefit)}
          </div>
        </div>
      </div>
    `}formatIngredientsHtml(e){return e.map(t=>{const n=this.formatRarityLabel(t.rarity);return`<li class="ingredient-item rarity-${t.rarity}">
        <span class="ingredient-name">${t.name}</span>
        <span class="ingredient-rarity">${n}</span>
      </li>`}).join("")}formatRarityLabel(e){const n={common:{label:"Common",icon:"●"},uncommon:{label:"Uncommon",icon:"◆"},rare:{label:"Rare",icon:"★"},legendary:{label:"Legendary",icon:"✦"}}[e]||{label:"Unknown",icon:"?"};return`${n.icon} ${n.label}`}formatSpiritualBenefitHtml(e){return e?`<p><strong>Spiritual Benefit:</strong> ${e}</p>`:""}}/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */var Tt=function(){var a={base:"https://twemoji.maxcdn.com/v/14.0.2/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:X,toCodePoint:x},onerror:function(){this.parentNode&&this.parentNode.replaceChild(d(this.alt,!1),this)},parse:q,replace:_,test:le},e={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},t=/(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef0-\udef6]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedd-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7c\ude80-\ude86\ude90-\udeac\udeb0-\udeba\udec0-\udec2\uded0-\uded9\udee0-\udee7]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,n=/\uFE0F/g,r="‍",i=/[&<>'"]/g,o=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,s=String.fromCharCode;return a;function d(l,u){return document.createTextNode(u?l.replace(n,""):l)}function c(l){return l.replace(i,R)}function g(l,u){return"".concat(u.base,u.size,"/",l,u.ext)}function m(l,u){for(var C=l.childNodes,p=C.length,y,v;p--;)y=C[p],v=y.nodeType,v===3?u.push(y):v===1&&!("ownerSVGElement"in y)&&!o.test(y.nodeName.toLowerCase())&&m(y,u);return u}function h(l){return x(l.indexOf(r)<0?l.replace(n,""):l)}function f(l,u){for(var C=m(l,[]),p=C.length,y,v,$,S,B,P,K,T,W,F,D,j,J;p--;){for($=!1,S=document.createDocumentFragment(),B=C[p],P=B.nodeValue,T=0;K=t.exec(P);){if(W=K.index,W!==T&&S.appendChild(d(P.slice(T,W),!0)),D=K[0],j=h(D),T=W+D.length,J=u.callback(j,u),j&&J){F=new Image,F.onerror=u.onerror,F.setAttribute("draggable","false"),y=u.attributes(D,j);for(v in y)y.hasOwnProperty(v)&&v.indexOf("on")!==0&&!F.hasAttribute(v)&&F.setAttribute(v,y[v]);F.className=u.className,F.alt=D,F.src=J,$=!0,S.appendChild(F)}F||S.appendChild(d(D,!1)),F=null}$&&(T<P.length&&S.appendChild(d(P.slice(T),!0)),B.parentNode.replaceChild(S,B))}return l}function w(l,u){return _(l,function(C){var p=C,y=h(C),v=u.callback(y,u),$,S;if(y&&v){p="<img ".concat('class="',u.className,'" ','draggable="false" ','alt="',C,'"',' src="',v,'"'),$=u.attributes(C,y);for(S in $)$.hasOwnProperty(S)&&S.indexOf("on")!==0&&p.indexOf(" "+S+"=")===-1&&(p=p.concat(" ",S,'="',c($[S]),'"'));p=p.concat("/>")}return p})}function R(l){return e[l]}function V(){return null}function Y(l){return typeof l=="number"?l+"x"+l:l}function X(l){var u=typeof l=="string"?parseInt(l,16):l;return u<65536?s(u):(u-=65536,s(55296+(u>>10),56320+(u&1023)))}function q(l,u){return(!u||typeof u=="function")&&(u={callback:u}),(typeof l=="string"?w:f)(l,{callback:u.callback||g,attributes:typeof u.attributes=="function"?u.attributes:V,base:typeof u.base=="string"?u.base:a.base,ext:u.ext||a.ext,size:u.folder||Y(u.size||a.size),className:u.className||a.className,onerror:u.onerror||a.onerror})}function _(l,u){return String(l).replace(t,u)}function le(l){t.lastIndex=0;var u=t.test(l);return t.lastIndex=0,u}function x(l,u){for(var C=[],p=0,y=0,v=0;v<l.length;)p=l.charCodeAt(v++),y?(C.push((65536+(y-55296<<10)+(p-56320)).toString(16)),y=0):55296<=p&&p<=56319?y=p:C.push(p.toString(16));return C.join(u||"-")}}();function G(a,e={}){const{size:t="medium",className:n="",alt:r,nation:i}=e,o=document.createElement("span");return o.className=`emoji-container emoji-${t} ${n}`,o.textContent=a.char,i&&o.classList.add(`emoji-nation-${i}`),r?o.setAttribute("aria-label",r):o.setAttribute("aria-label",a.name),Tt.parse(o,{folder:"svg",ext:".svg",base:"https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/",className:`twemoji emoji-svg emoji-${t}`}),o}function Dt(a,e="air-nomads"){const t=a.toLowerCase().split(" ");let n=null;for(const r of t){const i=ce(r);if(i.length>0){n=i[0];break}}return n||(n=z(e,"primary")),n||(n=St()),n?G(n,{size:"medium",className:"dish-name-emoji",nation:e,alt:`${n.name} emoji for ${a}`}):null}function Lt(a,e="air-nomads"){const t=ce(a);let n=null;return t.length>0?n=t[0]:n=z(e,"secondary"),n?G(n,{size:"small",className:"ingredient-emoji",nation:e,alt:`${n.name} emoji for ${a}`}):null}function Rt(a,e="air-nomads"){const t=z(e,"cultural");return t?G(t,{size:"medium",className:"cultural-emoji",nation:e,alt:`${t.name} emoji for ${a}`}):null}function Pt(a="air-nomads"){const e=z(a,"secondary");return e?G(e,{size:"small",className:"decorative-emoji",nation:a,alt:`Decorative ${e.name} emoji`}):null}function Mt(a,e){const t=e.nation||"air-nomads",n=a.querySelector(".dish-name");if(n){const o=Dt(e.name,t);if(o){const s=document.createTextNode(" ");n.insertBefore(o,n.firstChild),n.insertBefore(s,o.nextSibling)}}if(a.querySelectorAll(".ingredient-item").forEach((o,s)=>{if(s<e.ingredients.length){const d=Lt(e.ingredients[s],t);if(d){const c=document.createTextNode(" ");o.insertBefore(d,o.firstChild),o.insertBefore(c,d.nextSibling)}}}),e.culturalSignificance){const o=a.querySelector(".cultural-significance");if(o){const s=Rt(e.culturalSignificance,t);s&&o.insertBefore(s,o.firstChild)}}a.querySelectorAll(".emoji-decoration-point").forEach(()=>{Pt(t)})}async function Nt(){try{await kt(),qt(),console.log("✅ Emoji Renderer Initialized")}catch(a){console.error("Failed to initialize emoji renderer:",a)}}function qt(){const a=document.createElement("style");a.textContent=`
    .emoji-container {
      display: inline-block;
      vertical-align: middle;
      margin: 0 0.2em;
    }
    
    .emoji-small .twemoji {
      width: 1em;
      height: 1em;
    }
    
    .emoji-medium .twemoji {
      width: 1.2em;
      height: 1.2em;
    }
    
    .emoji-large .twemoji {
      width: 1.5em;
      height: 1.5em;
    }
    
    .emoji-xl .twemoji {
      width: 2em;
      height: 2em;
    }
    
    .dish-name-emoji {
      margin-right: 0.5em;
    }
    
    .ingredient-emoji {
      margin-right: 0.3em;
    }
    
    .cultural-emoji {
      margin-left: 0.3em;
    }
    
    .decorative-emoji {
      opacity: 0.7;
      margin: 0 0.1em;
    }
    
    /* Nation-specific theming */
    .emoji-nation-air-nomads {
      filter: hue-rotate(60deg) brightness(1.1);
    }
    
    .emoji-nation-water-tribe {
      filter: hue-rotate(200deg) brightness(1.1);
    }
    
    .emoji-nation-earth-kingdom {
      filter: hue-rotate(90deg) brightness(0.9);
    }
    
    .emoji-nation-fire-nation {
      filter: hue-rotate(0deg) brightness(1.2);
    }
    
    .emoji-picker {
      background: white;
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 1em;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .emoji-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(3em, 1fr));
      gap: 0.5em;
      max-height: 200px;
      overflow-y: auto;
    }
  `,document.head.appendChild(a)}const _t={gathering:["🌿 Gathering sacred ingredients from the temple gardens...","🍃 Selecting the finest Air Nomad herbs and fruits...","🌸 Consulting the ancient ingredient scrolls...","🌱 Choosing ingredients blessed by the spirits..."],cooking:["🔥 Channeling spiritual energy into cooking techniques...","🍜 Applying centuries-old Air Nomad cooking wisdom...","💨 Harnessing the power of airbending for perfect timing...","⚡ Infusing the dish with meditative focus..."],seasoning:["🧂 Adding the perfect balance of spiritual seasonings...","🌿 Harmonizing flavors with ancient spice blends...","✨ Adjusting taste to achieve inner peace...","🍯 Sweetening with temple monastery honey..."],plating:["🍽️ Arranging ingredients with artistic precision...","🎨 Creating beautiful presentation worthy of the Avatar...","🌟 Crafting a dish that pleases both eye and spirit...","🏺 Plating with the grace of Air Nomad masters..."],blessing:["🙏 Receiving blessings from the Air Nomad spirits...","🧘 Meditating on the dish's spiritual significance...","🕯️ Consecrating the meal for spiritual nourishment...","✨ Adding final touches of cosmic harmony..."]},Bt={gathering:["🌿","🍃","🌱","🌸","🍎","🥕"],cooking:["🍜","🔥","💨","⚡","🥘","🍲"],seasoning:["🧂","🌿","✨","🍯","🌾","🌰"],plating:["🍽️","🎨","🌟","🏺","🍵","🥗"],blessing:["🙏","🧘","🕯️","✨","☯️","🔮"]};class Wt{container;progressInterval=null;phaseTimeout=null;currentPhase="gathering";currentProgress=0;onComplete;constructor(e){this.container=document.getElementById(e)||document.body}async startLoadingAnimation(e){return new Promise(t=>{this.onComplete=()=>{e&&e(),t()},this.currentProgress=0,this.currentPhase="gathering",this.createLoadingUI(),this.startProgressAnimation(),this.cyclePhases(),setTimeout(()=>{this.completeLoading()},5e3)})}createLoadingUI(){this.container.insertAdjacentHTML("beforeend",`
      <div class="loading-overlay">
        <div class="loading-content">
          <div class="loading-emoji-container">
            <div class="loading-emoji" id="loading-emoji">🌿</div>
          </div>
          <div class="loading-caption" id="loading-caption">
            🌿 Gathering sacred ingredients from the temple gardens...
          </div>
          <div class="loading-progress-container">
            <div class="loading-progress-bar">
              <div class="loading-progress-fill" id="loading-progress-fill"></div>
            </div>
            <div class="loading-progress-text" id="loading-progress-text">0%</div>
          </div>
          <div class="loading-subtitle">
            Creating a completely unique Air Nomad dish! ✨
          </div>
        </div>
      </div>
    `),this.addLoadingStyles()}cyclePhases(){const e=["gathering","cooking","seasoning","plating","blessing"];let t=0;const n=()=>{t<e.length&&(this.currentPhase=e[t],this.updatePhaseDisplay(),t++,this.phaseTimeout=window.setTimeout(n,1e3))};n()}updatePhaseDisplay(){const e=document.getElementById("loading-emoji"),t=document.getElementById("loading-caption");if(e&&t){const n=Bt[this.currentPhase],r=n[Math.floor(Math.random()*n.length)],i=_t[this.currentPhase],o=i[Math.floor(Math.random()*i.length)];e.style.opacity="0",t.style.opacity="0",setTimeout(()=>{e.textContent=r,t.textContent=o;const s=["spin","float","bounce","pulse"],d=s[Math.floor(Math.random()*s.length)];e.className=`loading-emoji loading-${d}`,e.style.opacity="1",t.style.opacity="1"},200)}}startProgressAnimation(){const e=document.getElementById("loading-progress-fill"),t=document.getElementById("loading-progress-text"),n=Date.now(),r=5e3,i=50;this.progressInterval=window.setInterval(()=>{const o=Date.now()-n,s=Math.min(o/r*100,100),d=(Math.random()-.5)*3;this.currentProgress=Math.min(Math.max(s+d,0),100),o<4500&&this.currentProgress>95&&(this.currentProgress=95),e&&t&&(e.style.width=`${this.currentProgress}%`,t.textContent=`${Math.floor(this.currentProgress)}%`),o>=r&&(this.currentProgress=100,e&&t&&(e.style.width="100%",t.textContent="100%"),this.clearProgressInterval())},i)}completeLoading(){this.clearAllIntervals();const e=document.getElementById("loading-progress-fill"),t=document.getElementById("loading-progress-text");e&&t&&(e.style.width="100%",t.textContent="100%");const n=document.getElementById("loading-caption");n&&(n.textContent="✨ Your mystical Air Nomad dish is ready! ✨"),setTimeout(()=>{this.removeLoadingUI(),this.onComplete&&this.onComplete()},500)}removeLoadingUI(){const e=this.container.querySelector(".loading-overlay");e&&e.remove()}clearAllIntervals(){this.clearProgressInterval(),this.phaseTimeout&&(clearTimeout(this.phaseTimeout),this.phaseTimeout=null)}clearProgressInterval(){this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)}addLoadingStyles(){const e=document.createElement("style");e.textContent=`
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--theme-bg-overlay);
        backdrop-filter: blur(8px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        animation: fadeIn 0.3s ease-in;
      }

      .loading-content {
        text-align: center;
        background: var(--theme-bg-card);
        padding: 3rem;
        border-radius: 20px;
        box-shadow: var(--theme-shadow-heavy);
        border: 3px solid var(--theme-border-primary);
        max-width: 500px;
        width: 90%;
      }

      .loading-emoji-container {
        margin-bottom: 2rem;
      }

      .loading-emoji {
        font-size: 4rem;
        display: inline-block;
        transition: opacity 0.3s ease;
      }

      .loading-spin {
        animation: spin 2s linear infinite;
      }

      .loading-float {
        animation: float 3s ease-in-out infinite;
      }

      .loading-bounce {
        animation: bounce 1.5s ease-in-out infinite;
      }

      .loading-pulse {
        animation: pulse 2s ease-in-out infinite;
      }

      .loading-shake {
        animation: shake 0.5s ease-in-out infinite;
      }

      .loading-caption {
        font-size: 1.2rem;
        color: var(--theme-text-primary);
        margin-bottom: 2rem;
        font-weight: 500;
        transition: opacity 0.3s ease;
        line-height: 1.4;
      }

      .loading-progress-container {
        margin-bottom: 1.5rem;
      }

      .loading-progress-bar {
        width: 100%;
        height: 20px;
        background: var(--theme-bg-secondary);
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 0.5rem;
        border: 2px solid var(--theme-border-secondary);
      }

      .loading-progress-fill {
        height: 100%;
        background: var(--theme-gradient-button);
        border-radius: 8px;
        transition: width 0.3s ease;
        background-size: 200% 100%;
        animation: shimmer 2s linear infinite;
      }

      .loading-progress-text {
        font-size: 1rem;
        color: var(--theme-text-primary);
        font-weight: 600;
      }

      .loading-subtitle {
        font-size: 1rem;
        color: var(--theme-text-secondary);
        font-style: italic;
        margin-top: 1rem;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.9); }
        to { opacity: 1; transform: scale(1); }
      }

      @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }

      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-20px); }
      }

      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-30px); }
        60% { transform: translateY(-15px); }
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
      }

      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
      }

      @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
    `,document.head.appendChild(e)}forceStop(){this.clearAllIntervals(),this.removeLoadingUI()}}const jt={light:{name:"Air Nomads Light",primary:"#FF9500",secondary:"#FFB84D",accent:"#FFC107",background:{primary:"linear-gradient(135deg, #FFF3E0 0%, #FFE0B3 100%)",secondary:"#FFFDF7",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(255, 249, 240, 0.98)"},text:{primary:"#2E1500",secondary:"#5D2F00",accent:"#E6850E"},borders:{primary:"#FFD699",secondary:"#F0F0F0"},shadows:{light:"0 2px 8px rgba(255, 149, 0, 0.15)",medium:"0 4px 15px rgba(255, 149, 0, 0.25)",heavy:"0 8px 32px rgba(255, 149, 0, 0.35)"},gradients:{background:"linear-gradient(135deg, #FFF3E0 0%, #FFE0B3 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #FFF8F0 100%)",button:"linear-gradient(45deg, #FF9500, #E6850E)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(255, 149, 0, 0.15)",border:"rgba(255, 149, 0, 0.4)"},legendary:{background:"rgba(255, 193, 7, 0.15)",border:"rgba(255, 193, 7, 0.4)",glow:"rgba(255, 193, 7, 0.3)"}}},dark:{name:"Air Nomads Dark",primary:"#FFB74D",secondary:"#FFCC80",accent:"#FFD54F",background:{primary:"linear-gradient(135deg, #1A0F00 0%, #2D1A00 50%, #1A0F00 100%)",secondary:"#2D1A00",card:"rgba(45, 26, 0, 0.9)",overlay:"rgba(61, 35, 0, 0.95)"},text:{primary:"#FFF8E1",secondary:"#FFECB3",accent:"#FFB74D"},borders:{primary:"rgba(255, 183, 77, 0.3)",secondary:"rgba(255, 236, 179, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #1A0F00 0%, #2D1A00 50%, #1A0F00 100%)",card:"linear-gradient(145deg, rgba(45, 26, 0, 0.9) 0%, rgba(61, 35, 0, 0.8) 100%)",button:"linear-gradient(45deg, #FFB74D, #FF9500)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(255, 183, 77, 0.2)",border:"rgba(255, 183, 77, 0.5)"},legendary:{background:"rgba(255, 213, 79, 0.2)",border:"rgba(255, 213, 79, 0.5)",glow:"rgba(255, 213, 79, 0.4)"}}}},Ot={light:{name:"Water Tribe Light",primary:"#0288D1",secondary:"#03A9F4",accent:"#00BCD4",background:{primary:"linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%)",secondary:"#FAFFFE",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(227, 242, 253, 0.98)"},text:{primary:"#01579B",secondary:"#0277BD",accent:"#0288D1"},borders:{primary:"#90CAF9",secondary:"#E0E0E0"},shadows:{light:"0 2px 8px rgba(2, 136, 209, 0.15)",medium:"0 4px 15px rgba(2, 136, 209, 0.25)",heavy:"0 8px 32px rgba(2, 136, 209, 0.35)"},gradients:{background:"linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #F3F9FF 100%)",button:"linear-gradient(45deg, #0288D1, #01579B)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(2, 136, 209, 0.15)",border:"rgba(2, 136, 209, 0.4)"},legendary:{background:"rgba(38, 198, 218, 0.15)",border:"rgba(38, 198, 218, 0.4)",glow:"rgba(38, 198, 218, 0.3)"}}},dark:{name:"Water Tribe Dark",primary:"#29B6F6",secondary:"#4FC3F7",accent:"#26C6DA",background:{primary:"linear-gradient(135deg, #0D1B2A 0%, #1B263B 50%, #0D1B2A 100%)",secondary:"#1B263B",card:"rgba(27, 38, 59, 0.9)",overlay:"rgba(21, 32, 43, 0.95)"},text:{primary:"#E1F5FE",secondary:"#B3E5FC",accent:"#29B6F6"},borders:{primary:"rgba(41, 182, 246, 0.3)",secondary:"rgba(179, 229, 252, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #0D1B2A 0%, #1B263B 50%, #0D1B2A 100%)",card:"linear-gradient(145deg, rgba(27, 38, 59, 0.9) 0%, rgba(21, 32, 43, 0.8) 100%)",button:"linear-gradient(45deg, #29B6F6, #0288D1)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(41, 182, 246, 0.2)",border:"rgba(41, 182, 246, 0.5)"},legendary:{background:"rgba(38, 198, 218, 0.2)",border:"rgba(38, 198, 218, 0.5)",glow:"rgba(38, 198, 218, 0.4)"}}}},Ut={light:{name:"Earth Kingdom Light",primary:"#388E3C",secondary:"#66BB6A",accent:"#8BC34A",background:{primary:"linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%)",secondary:"#FAFFFE",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(241, 248, 233, 0.98)"},text:{primary:"#1B5E20",secondary:"#2E7D32",accent:"#388E3C"},borders:{primary:"#A5D6A7",secondary:"#E0E0E0"},shadows:{light:"0 2px 8px rgba(56, 142, 60, 0.15)",medium:"0 4px 15px rgba(56, 142, 60, 0.25)",heavy:"0 8px 32px rgba(56, 142, 60, 0.35)"},gradients:{background:"linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #F9FDF7 100%)",button:"linear-gradient(45deg, #388E3C, #2E7D32)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(56, 142, 60, 0.15)",border:"rgba(56, 142, 60, 0.4)"},legendary:{background:"rgba(139, 195, 74, 0.15)",border:"rgba(139, 195, 74, 0.4)",glow:"rgba(139, 195, 74, 0.3)"}}},dark:{name:"Earth Kingdom Dark",primary:"#66BB6A",secondary:"#81C784",accent:"#9CCC65",background:{primary:"linear-gradient(135deg, #0F1B0C 0%, #1B2E15 50%, #0F1B0C 100%)",secondary:"#1B2E15",card:"rgba(27, 46, 21, 0.9)",overlay:"rgba(24, 39, 18, 0.95)"},text:{primary:"#E8F5E8",secondary:"#C8E6C9",accent:"#66BB6A"},borders:{primary:"rgba(102, 187, 106, 0.3)",secondary:"rgba(200, 230, 201, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #0F1B0C 0%, #1B2E15 50%, #0F1B0C 100%)",card:"linear-gradient(145deg, rgba(27, 46, 21, 0.9) 0%, rgba(24, 39, 18, 0.8) 100%)",button:"linear-gradient(45deg, #66BB6A, #388E3C)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(102, 187, 106, 0.2)",border:"rgba(102, 187, 106, 0.5)"},legendary:{background:"rgba(156, 204, 101, 0.2)",border:"rgba(156, 204, 101, 0.5)",glow:"rgba(156, 204, 101, 0.4)"}}}},Ht={light:{name:"Fire Nation Light",primary:"#D32F2F",secondary:"#F44336",accent:"#FF9800",background:{primary:"linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%)",secondary:"#FFFBFA",card:"rgba(255, 255, 255, 0.95)",overlay:"rgba(255, 235, 238, 0.98)"},text:{primary:"#B71C1C",secondary:"#C62828",accent:"#D32F2F"},borders:{primary:"#EF9A9A",secondary:"#E0E0E0"},shadows:{light:"0 2px 8px rgba(211, 47, 47, 0.15)",medium:"0 4px 15px rgba(211, 47, 47, 0.25)",heavy:"0 8px 32px rgba(211, 47, 47, 0.35)"},gradients:{background:"linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%)",card:"linear-gradient(145deg, #FFFFFF 0%, #FFF8F7 100%)",button:"linear-gradient(45deg, #D32F2F, #B71C1C)"},rarity:{uncommon:{color:"#2E7D32",background:"rgba(46, 125, 50, 0.15)",border:"rgba(46, 125, 50, 0.4)"},rare:{background:"rgba(211, 47, 47, 0.15)",border:"rgba(211, 47, 47, 0.4)"},legendary:{background:"rgba(255, 152, 0, 0.15)",border:"rgba(255, 152, 0, 0.4)",glow:"rgba(255, 152, 0, 0.3)"}}},dark:{name:"Fire Nation Dark",primary:"#EF5350",secondary:"#FF7043",accent:"#FFB74D",background:{primary:"linear-gradient(135deg, #1A0606 0%, #2E0A0A 50%, #1A0606 100%)",secondary:"#2E0A0A",card:"rgba(46, 10, 10, 0.9)",overlay:"rgba(42, 12, 12, 0.95)"},text:{primary:"#FFEBEE",secondary:"#FFCDD2",accent:"#EF5350"},borders:{primary:"rgba(239, 83, 80, 0.3)",secondary:"rgba(255, 205, 210, 0.2)"},shadows:{light:"0 2px 8px rgba(0, 0, 0, 0.4)",medium:"0 4px 15px rgba(0, 0, 0, 0.5)",heavy:"0 8px 32px rgba(0, 0, 0, 0.6)"},gradients:{background:"linear-gradient(135deg, #1A0606 0%, #2E0A0A 50%, #1A0606 100%)",card:"linear-gradient(145deg, rgba(46, 10, 10, 0.9) 0%, rgba(42, 12, 12, 0.8) 100%)",button:"linear-gradient(45deg, #EF5350, #D32F2F)"},rarity:{uncommon:{color:"#4CAF50",background:"rgba(76, 175, 80, 0.2)",border:"rgba(76, 175, 80, 0.5)"},rare:{background:"rgba(239, 83, 80, 0.2)",border:"rgba(239, 83, 80, 0.5)"},legendary:{background:"rgba(255, 183, 77, 0.2)",border:"rgba(255, 183, 77, 0.5)",glow:"rgba(255, 183, 77, 0.4)"}}}},re={"air-nomads":jt,"water-tribe":Ot,"earth-kingdom":Ut,"fire-nation":Ht};class zt{currentNation="air-nomads";currentVariant="dark";appliedTheme=null;applyTheme(e=this.currentNation,t=this.currentVariant){const n=re[e][t];this.appliedTheme=n,this.currentNation=e,this.currentVariant=t;const r=document.documentElement;r.style.setProperty("--theme-primary",n.primary),r.style.setProperty("--theme-secondary",n.secondary),r.style.setProperty("--theme-accent",n.accent),r.style.setProperty("--theme-bg-primary",n.background.primary),r.style.setProperty("--theme-bg-secondary",n.background.secondary),r.style.setProperty("--theme-bg-card",n.background.card),r.style.setProperty("--theme-bg-overlay",n.background.overlay),r.style.setProperty("--theme-text-primary",n.text.primary),r.style.setProperty("--theme-text-secondary",n.text.secondary),r.style.setProperty("--theme-text-accent",n.text.accent),r.style.setProperty("--theme-border-primary",n.borders.primary),r.style.setProperty("--theme-border-secondary",n.borders.secondary),r.style.setProperty("--theme-shadow-light",n.shadows.light),r.style.setProperty("--theme-shadow-medium",n.shadows.medium),r.style.setProperty("--theme-shadow-heavy",n.shadows.heavy),r.style.setProperty("--theme-gradient-background",n.gradients.background),r.style.setProperty("--theme-gradient-card",n.gradients.card),r.style.setProperty("--theme-gradient-button",n.gradients.button),r.style.setProperty("--rarity-uncommon-color",n.rarity.uncommon.color),r.style.setProperty("--rarity-uncommon-bg",n.rarity.uncommon.background),r.style.setProperty("--rarity-uncommon-border",n.rarity.uncommon.border),r.style.setProperty("--rarity-rare-bg",n.rarity.rare.background),r.style.setProperty("--rarity-rare-border",n.rarity.rare.border),r.style.setProperty("--rarity-legendary-bg",n.rarity.legendary.background),r.style.setProperty("--rarity-legendary-border",n.rarity.legendary.border),r.style.setProperty("--rarity-legendary-glow",n.rarity.legendary.glow),document.body.className=`theme-${e} theme-${t}`,localStorage.setItem("avatar-theme-nation",e),localStorage.setItem("avatar-theme-variant",t),console.log(`🎨 Applied ${n.name} theme`)}toggleVariant(){const e=this.currentVariant==="light"?"dark":"light";this.applyTheme(this.currentNation,e)}switchNation(e){this.applyTheme(e,this.currentVariant)}getCurrentTheme(){return{nation:this.currentNation,variant:this.currentVariant,theme:this.appliedTheme}}initializeFromStorage(){const e=localStorage.getItem("avatar-theme-nation")||"air-nomads",t=localStorage.getItem("avatar-theme-variant")||"dark";this.applyTheme(e,t)}getAvailableNations(){return Object.keys(re)}getTheme(e,t){return re[e][t]}}const L=new zt;async function oe(){return new Promise(a=>setTimeout(a,0))}function Gt(){const a=document.getElementById("theme-toggle");if(a){const t=L.getCurrentTheme();a.textContent=t.variant==="dark"?"☀️ Light Theme":"🌙 Dark Theme",a.addEventListener("click",()=>{L.toggleVariant();const n=L.getCurrentTheme();a.textContent=n.variant==="dark"?"☀️ Light Theme":"🌙 Dark Theme",console.log(`🎨 Switched to ${n.theme?.name}`)})}else console.warn("Theme toggle button not found in DOM");const e=document.getElementById("nation-selector");if(e){const t=L.getCurrentTheme();e.value=t.nation,e.addEventListener("change",n=>{const r=n.target.value;L.switchNation(r),console.log(`🎨 Switched to ${r} theme`);const i=document.getElementById("generate-button");if(i){const o={"air-nomads":"Air Nomad","water-tribe":"Water Tribe","earth-kingdom":"Earth Kingdom","fire-nation":"Fire Nation"};i.textContent=`Generate ${o[r]} Dish`}})}else console.warn("Nation selector not found in DOM")}async function we(){const a=document.getElementById("generate-button"),e=new be("dish-container"),t=new Wt("body");try{a.disabled=!0,a.textContent="Generating...",await t.startLoadingAnimation(),await oe();const n=new ct,r=At.forMainCourse(),i=n.createDish(r);await oe(),e.renderDish(i);const o=document.getElementById("dish-container");if(o&&i){const s={name:i.name,ingredients:i.ingredients.map(d=>d.name),culturalSignificance:i.culturalBenefit,nation:"air-nomads"};Mt(o,s)}}catch(n){console.error("Error generating dish:",n),t.forceStop();const r=document.getElementById("dish-container");r&&(r.innerHTML=`
        <div class="error-message">
          <h3>Generation Error</h3>
          <p>Unable to generate dish. Please try again.</p>
          <small>Error: ${n instanceof Error?n.message:"Unknown error"}</small>
        </div>
      `)}finally{a.disabled=!1,a.textContent="Generate New Dish"}}async function me(){console.log("🍲 Air Nomad Food Generator - Sovereign Architecture Initialized...");try{L.initializeFromStorage(),console.log("🎨 Theme system initialized with Air Nomad dark theme")}catch(t){console.warn("⚠️ Theme system failed to initialize:",t)}try{await Nt(),console.log("✅ Emoji system initialized")}catch(t){console.warn("⚠️ Emoji system failed to initialize:",t)}const a=document.getElementById("generate-button");a?a.addEventListener("click",async()=>{await we()}):console.warn("Generate button not found in DOM"),Gt(),new be("dish-container").renderDish(null),console.log("✨ Sovereign Architecture: SovereignDishGenerator + Air Nomad Data Provider + Loading Animation")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",async()=>{await me()}):await me();window.generateDish=we;window.yieldToEventLoop=oe;
